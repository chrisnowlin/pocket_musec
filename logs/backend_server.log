INFO:     Will watch for changes in these directories: ['/Users/cnowlin/Developer/pocket_musec']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [80830] using WatchFiles
Starting PocketMusec API server...
Host: 0.0.0.0
Port: 8000
Auto-reload: True
API Docs: http://0.0.0.0:8000/api/docs

INFO:     Started server process [80850]
INFO:     Waiting for application startup.
2025-11-14 11:33:30,152 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 11:33:30,152 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 11:33:30,155 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 11:33:30,155 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 11:33:30,156 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 11:33:30,157 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 11:33:30,157 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 11:33:30,157 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 11:33:30,157 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 11:33:30,158 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 11:33:30,158 - backend.api.main - INFO - Database migrations completed
2025-11-14 11:33:30,158 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:59357 - "GET /health HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_lesson_refinement.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 11:33:51,067 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [80850]
INFO:     Started server process [81394]
INFO:     Waiting for application startup.
2025-11-14 11:33:52,159 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 11:33:52,159 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 11:33:52,162 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 11:33:52,162 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 11:33:52,163 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 11:33:52,164 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 11:33:52,164 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 11:33:52,164 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 11:33:52,164 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 11:33:52,164 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 11:33:52,164 - backend.api.main - INFO - Database migrations completed
2025-11-14 11:33:52,164 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 11:33:58,974 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:33:58,975 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59373 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 11:33:58,981 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:33:58,981 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:33:58,981 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:33:58,981 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:33:58,981 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:33:58,982 - backend.api.routes.sessions - INFO - Conversation history saved for session 0e9f7f2b-25c0-4413-85c6-4df49d9061d6
2025-11-14 11:34:01,509 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.53s
2025-11-14 11:34:16,885 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.33s
2025-11-14 11:34:16,885 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 17.90s (thread pool)
INFO:     127.0.0.1:59375 - "POST /api/sessions/0e9f7f2b-25c0-4413-85c6-4df49d9061d6/messages HTTP/1.1" 200 OK
2025-11-14 11:34:16,895 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:34:16,896 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:34:16,896 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:34:16,896 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:34:16,896 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:34:16,896 - backend.api.routes.sessions - INFO - Restored 2 messages to conversation history
2025-11-14 11:34:16,897 - backend.api.routes.sessions - INFO - Conversation history saved for session 0e9f7f2b-25c0-4413-85c6-4df49d9061d6
2025-11-14 11:34:31,221 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.92s
2025-11-14 11:34:31,222 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 10.92s (thread pool)
INFO:     127.0.0.1:59380 - "POST /api/sessions/0e9f7f2b-25c0-4413-85c6-4df49d9061d6/messages HTTP/1.1" 200 OK
2025-11-14 11:34:43,200 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:34:43,201 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59389 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 11:34:43,205 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:34:43,206 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:34:43,206 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:34:43,206 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:34:43,206 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:34:43,207 - backend.api.routes.sessions - INFO - Conversation history saved for session d92792a1-af93-47e0-9f35-6ba078c090bf
2025-11-14 11:34:44,723 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.52s
2025-11-14 11:34:58,153 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 8.57s
2025-11-14 11:34:58,153 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 14.95s (thread pool)
INFO:     127.0.0.1:59391 - "POST /api/sessions/d92792a1-af93-47e0-9f35-6ba078c090bf/messages HTTP/1.1" 200 OK
2025-11-14 11:35:30,319 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:30,319 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:35:30,319 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:30,319 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:35:30,320 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:35:30,320 - backend.api.routes.sessions - INFO - Restored 7 messages to conversation history
2025-11-14 11:35:30,324 - backend.api.routes.sessions - INFO - Conversation history saved for session 4581eb33-69a8-45f1-bc69-10f31601aec7
INFO:     127.0.0.1:59403 - "POST /api/sessions/4581eb33-69a8-45f1-bc69-10f31601aec7/messages HTTP/1.1" 200 OK
2025-11-14 11:35:38,705 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:38,705 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:35:38,706 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:38,706 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:35:38,706 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:35:38,706 - backend.api.routes.sessions - INFO - Restored 9 messages to conversation history
2025-11-14 11:35:38,709 - backend.api.routes.sessions - INFO - Conversation history saved for session 4581eb33-69a8-45f1-bc69-10f31601aec7
INFO:     127.0.0.1:59405 - "POST /api/sessions/4581eb33-69a8-45f1-bc69-10f31601aec7/messages HTTP/1.1" 200 OK
2025-11-14 11:35:50,864 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:50,865 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59408 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 11:35:50,876 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:50,876 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:35:50,876 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:35:50,876 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:35:50,876 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:35:50,878 - backend.api.routes.sessions - INFO - Conversation history saved for session 47900adf-aca1-4892-88c4-1a3a8ae7cb99
2025-11-14 11:35:52,924 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.05s
2025-11-14 11:36:03,486 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 8.07s
2025-11-14 11:36:03,487 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 12.61s (thread pool)
INFO:     127.0.0.1:59410 - "POST /api/sessions/47900adf-aca1-4892-88c4-1a3a8ae7cb99/messages HTTP/1.1" 200 OK
2025-11-14 11:36:03,497 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:36:03,497 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:36:03,497 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:36:03,498 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:36:03,498 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 11:36:03,498 - backend.api.routes.sessions - INFO - Restored 2 messages to conversation history
2025-11-14 11:36:03,499 - backend.api.routes.sessions - INFO - Conversation history saved for session 47900adf-aca1-4892-88c4-1a3a8ae7cb99
2025-11-14 11:36:16,594 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.49s
2025-11-14 11:36:16,594 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 9.49s (thread pool)
INFO:     127.0.0.1:59417 - "POST /api/sessions/47900adf-aca1-4892-88c4-1a3a8ae7cb99/messages HTTP/1.1" 200 OK
2025-11-14 11:36:24,377 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:36:24,378 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59424 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 11:53:34,486 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,488 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:53:34,510 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,510 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:53:34,527 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,527 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59650 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:59652 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:59653 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:59654 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:59649 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:59651 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:59660 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 11:53:34,538 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,539 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:53:34,540 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,541 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 11:53:34,551 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,551 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59664 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:59667 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:59669 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:59672 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:59673 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:59674 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 11:53:34,569 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,569 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59677 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:59660 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 11:53:34,574 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 11:53:34,574 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59680 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 12:02:48,619 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:02:48,619 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59785 - "PUT /api/sessions/eed96f68-9475-468b-9b40-d8ed8bdcc21a HTTP/1.1" 200 OK
2025-11-14 12:02:48,621 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:02:48,621 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:59788 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 12:02:48,638 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:02:48,638 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:02:48,638 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:02:48,639 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:02:48,639 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:02:48,641 - backend.api.routes.sessions - INFO - Conversation history saved for session eed96f68-9475-468b-9b40-d8ed8bdcc21a
2025-11-14 12:02:52,122 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 3.48s
2025-11-14 12:03:05,545 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.63s
2025-11-14 12:03:05,545 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 16.90s (thread pool)
INFO:     127.0.0.1:59791 - "POST /api/sessions/eed96f68-9475-468b-9b40-d8ed8bdcc21a/messages/stream HTTP/1.1" 200 OK
2025-11-14 12:04:08,202 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:04:08,202 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:04:08,202 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:04:08,203 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:04:08,203 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:04:08,203 - backend.api.routes.sessions - INFO - Restored 3 messages to conversation history
2025-11-14 12:04:08,205 - backend.api.routes.sessions - INFO - Conversation history saved for session eed96f68-9475-468b-9b40-d8ed8bdcc21a
2025-11-14 12:04:08,205 - backend.pocketflow.lesson_agent - INFO - Searching for teaching strategies with query: teaching strategies pedagogical approaches instructional methods activities
2025-11-14 12:04:09,978 - backend.pocketflow.lesson_agent - INFO - No teaching strategies found in standards
2025-11-14 12:04:09,978 - backend.pocketflow.lesson_agent - INFO - Searching for assessment guidance with query: assessment strategies evaluation methods rubrics formative assessment
2025-11-14 12:04:14,045 - backend.pocketflow.lesson_agent - INFO - No assessment guidance found in standards
2025-11-14 12:04:14,045 - backend.pocketflow.lesson_agent - INFO - No musical topics provided for web search
2025-11-14 12:04:41,894 - backend.pocketflow.lesson_agent - INFO - LLM lesson plan generation took 27.85s
2025-11-14 12:04:41,895 - backend.pocketflow.lesson_agent - INFO - Lesson plan generated in 33.69s (thread pool)
INFO:     127.0.0.1:59810 - "POST /api/sessions/eed96f68-9475-468b-9b40-d8ed8bdcc21a/messages/stream HTTP/1.1" 200 OK
2025-11-14 12:05:15,309 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:05:15,310 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:05:15,310 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:05:15,310 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:05:15,310 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:05:15,310 - backend.api.routes.sessions - INFO - Restored 6 messages to conversation history
2025-11-14 12:05:15,313 - backend.api.routes.sessions - INFO - Conversation history saved for session eed96f68-9475-468b-9b40-d8ed8bdcc21a
INFO:     127.0.0.1:59826 - "POST /api/sessions/eed96f68-9475-468b-9b40-d8ed8bdcc21a/messages/stream HTTP/1.1" 200 OK
2025-11-14 12:19:39,865 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:19:39,866 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:19:39,866 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:19:39,866 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:19:39,866 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:19:39,867 - backend.api.routes.sessions - INFO - Restored 9 messages to conversation history
2025-11-14 12:19:39,871 - backend.api.routes.sessions - INFO - Conversation history saved for session eed96f68-9475-468b-9b40-d8ed8bdcc21a
INFO:     127.0.0.1:59976 - "POST /api/sessions/eed96f68-9475-468b-9b40-d8ed8bdcc21a/messages/stream HTTP/1.1" 200 OK
2025-11-14 12:20:54,449 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:20:54,449 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:20:54,449 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:20:54,450 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:20:54,450 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:20:54,450 - backend.api.routes.sessions - INFO - Restored 12 messages to conversation history
2025-11-14 12:20:54,454 - backend.api.routes.sessions - INFO - Conversation history saved for session eed96f68-9475-468b-9b40-d8ed8bdcc21a
INFO:     127.0.0.1:59987 - "POST /api/sessions/eed96f68-9475-468b-9b40-d8ed8bdcc21a/messages/stream HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_refinement_quality.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 12:51:59,119 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [81394]
WARNING:  WatchFiles detected changes in 'test_refinement_quality.py'. Reloading...
INFO:     Started server process [17961]
INFO:     Waiting for application startup.
2025-11-14 12:52:00,753 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 12:52:00,753 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 12:52:00,756 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 12:52:00,757 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 12:52:00,758 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 12:52:00,758 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 12:52:00,760 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 12:52:00,760 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 12:52:00,760 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 12:52:00,760 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 12:52:00,760 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 12:52:00,761 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 12:52:00,763 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 12:52:00,763 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 12:52:00,764 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 12:52:00,764 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 12:52:00,764 - backend.api.main - INFO - Database migrations completed
2025-11-14 12:52:00,764 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_refinement_quality.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 12:52:04,927 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [17961]
INFO:     Started server process [18279]
INFO:     Waiting for application startup.
2025-11-14 12:52:06,408 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 12:52:06,408 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 12:52:06,410 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 12:52:06,410 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 12:52:06,411 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 12:52:06,412 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 12:52:06,412 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 12:52:06,413 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 12:52:06,413 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 12:52:06,413 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 12:52:06,413 - backend.api.main - INFO - Database migrations completed
2025-11-14 12:52:06,413 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_refinement_quality.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 12:53:05,779 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [18279]
INFO:     Started server process [20380]
INFO:     Waiting for application startup.
2025-11-14 12:53:07,281 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 12:53:07,281 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 12:53:07,284 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 12:53:07,285 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 12:53:07,285 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 12:53:07,285 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 12:53:07,286 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 12:53:07,286 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 12:53:07,286 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 12:53:07,286 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 12:53:07,287 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 12:53:07,287 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 12:53:07,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 12:53:07,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 12:53:07,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 12:53:07,288 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 12:53:07,288 - backend.api.main - INFO - Database migrations completed
2025-11-14 12:53:07,288 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 12:53:11,210 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:11,211 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60391 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 12:53:11,218 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:11,219 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:53:11,219 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:11,219 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:53:11,219 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:53:11,221 - backend.api.routes.sessions - INFO - Conversation history saved for session e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9
2025-11-14 12:53:13,155 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.93s
2025-11-14 12:53:25,363 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.54s
2025-11-14 12:53:25,364 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 14.14s (thread pool)
INFO:     127.0.0.1:60393 - "POST /api/sessions/e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9/messages HTTP/1.1" 200 OK
2025-11-14 12:53:26,384 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:26,385 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:53:26,385 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:26,385 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:53:26,385 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:53:26,385 - backend.api.routes.sessions - INFO - Restored 2 messages to conversation history
2025-11-14 12:53:26,387 - backend.api.routes.sessions - INFO - Conversation history saved for session e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9
2025-11-14 12:53:42,410 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.29s
2025-11-14 12:53:42,411 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 10.29s (thread pool)
INFO:     127.0.0.1:60403 - "POST /api/sessions/e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9/messages HTTP/1.1" 200 OK
2025-11-14 12:53:43,432 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:43,433 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:53:43,433 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:53:43,433 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:53:43,433 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:53:43,433 - backend.api.routes.sessions - INFO - Restored 4 messages to conversation history
2025-11-14 12:53:43,435 - backend.api.routes.sessions - INFO - Conversation history saved for session e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9
2025-11-14 12:54:00,552 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.64s
2025-11-14 12:54:00,569 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 11.66s (thread pool)
INFO:     127.0.0.1:60409 - "POST /api/sessions/e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9/messages HTTP/1.1" 200 OK
2025-11-14 12:54:01,616 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:54:01,617 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:54:01,617 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:54:01,617 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:54:01,617 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:54:01,617 - backend.api.routes.sessions - INFO - Restored 6 messages to conversation history
2025-11-14 12:54:01,619 - backend.api.routes.sessions - INFO - Conversation history saved for session e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9
2025-11-14 12:54:16,821 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.93s
2025-11-14 12:54:16,824 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 10.93s (thread pool)
INFO:     127.0.0.1:60417 - "POST /api/sessions/e407dd5a-7ffc-48e7-9fbd-7daf2c24cbc9/messages HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_objectives_in_lesson_generation.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 12:58:15,916 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [20380]
WARNING:  WatchFiles detected changes in 'test_objectives_in_lesson_generation.py'. Reloading...
INFO:     Started server process [30036]
INFO:     Waiting for application startup.
2025-11-14 12:58:17,457 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 12:58:17,457 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 12:58:17,461 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 12:58:17,461 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 12:58:17,461 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 12:58:17,461 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 12:58:17,462 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 12:58:17,462 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 12:58:17,462 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 12:58:17,462 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 12:58:17,462 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 12:58:17,462 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 12:58:17,463 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 12:58:17,463 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 12:58:17,463 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 12:58:17,463 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 12:58:17,463 - backend.api.main - INFO - Database migrations completed
2025-11-14 12:58:17,463 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 12:58:17,856 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:17,856 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60494 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 12:58:17,863 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:17,864 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:58:17,864 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:17,864 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:58:17,864 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:58:17,865 - backend.api.routes.sessions - INFO - Conversation history saved for session 82138416-5b87-49a6-a278-7ab9ee71a961
2025-11-14 12:58:21,610 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 3.74s
2025-11-14 12:58:35,138 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.75s
2025-11-14 12:58:35,140 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 17.28s (thread pool)
INFO:     127.0.0.1:60496 - "POST /api/sessions/82138416-5b87-49a6-a278-7ab9ee71a961/messages HTTP/1.1" 200 OK
2025-11-14 12:58:36,198 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:36,200 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:58:36,201 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:36,201 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:58:36,203 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:58:36,204 - backend.api.routes.sessions - INFO - Restored 2 messages to conversation history
2025-11-14 12:58:36,215 - backend.api.routes.sessions - INFO - Conversation history saved for session 82138416-5b87-49a6-a278-7ab9ee71a961
2025-11-14 12:58:52,949 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.04s
2025-11-14 12:58:52,951 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 11.05s (thread pool)
INFO:     127.0.0.1:60508 - "POST /api/sessions/82138416-5b87-49a6-a278-7ab9ee71a961/messages HTTP/1.1" 200 OK
2025-11-14 12:58:52,974 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:52,974 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60514 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 12:58:52,982 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:52,982 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:58:52,982 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:58:52,982 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:58:52,983 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:58:52,984 - backend.api.routes.sessions - INFO - Conversation history saved for session 2d2e7b80-3237-4638-8c33-3f3552c85d50
2025-11-14 12:58:55,278 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.29s
2025-11-14 12:59:08,986 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.64s
2025-11-14 12:59:08,989 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 16.01s (thread pool)
INFO:     127.0.0.1:60516 - "POST /api/sessions/2d2e7b80-3237-4638-8c33-3f3552c85d50/messages HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_objectives_fixed.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 12:59:27,903 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [30036]
WARNING:  WatchFiles detected changes in 'test_objectives_fixed.py'. Reloading...
INFO:     Started server process [33480]
INFO:     Waiting for application startup.
2025-11-14 12:59:29,460 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 12:59:29,460 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 12:59:29,464 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 12:59:29,465 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 12:59:29,466 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 12:59:29,466 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 12:59:29,466 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 12:59:29,466 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 12:59:29,467 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 12:59:29,467 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 12:59:29,467 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 12:59:29,467 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 12:59:29,468 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 12:59:29,468 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 12:59:29,468 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 12:59:29,468 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 12:59:29,468 - backend.api.main - INFO - Database migrations completed
2025-11-14 12:59:29,468 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 12:59:29,790 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:59:29,791 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60533 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 12:59:29,797 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:59:29,798 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:59:29,798 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:59:29,798 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:59:29,798 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:59:29,800 - backend.api.routes.sessions - INFO - Conversation history saved for session 1ae6b0e0-c129-4e34-9b69-401add38af36
2025-11-14 12:59:33,337 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 3.54s
2025-11-14 12:59:45,941 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.49s
2025-11-14 12:59:45,944 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 16.14s (thread pool)
INFO:     127.0.0.1:60535 - "POST /api/sessions/1ae6b0e0-c129-4e34-9b69-401add38af36/messages HTTP/1.1" 200 OK
2025-11-14 12:59:45,971 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:59:45,971 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60545 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 12:59:45,977 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:59:45,977 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:59:45,977 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 12:59:45,978 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 12:59:45,978 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 12:59:45,980 - backend.api.routes.sessions - INFO - Conversation history saved for session cac454c8-0ed8-4b17-b938-d3c0de9f6c05
2025-11-14 12:59:48,554 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.57s
2025-11-14 13:00:03,534 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.48s
2025-11-14 13:00:03,540 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 17.56s (thread pool)
INFO:     127.0.0.1:60547 - "POST /api/sessions/cac454c8-0ed8-4b17-b938-d3c0de9f6c05/messages HTTP/1.1" 200 OK
2025-11-14 13:00:03,561 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:00:03,562 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60554 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:00:03,568 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:00:03,568 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:00:03,568 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:00:03,569 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:00:03,570 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:00:03,572 - backend.api.routes.sessions - INFO - Conversation history saved for session a316968a-2cd3-42f0-a782-8ff00fbccfd7
2025-11-14 13:00:15,689 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 12.12s
2025-11-14 13:00:30,431 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 12.29s
2025-11-14 13:00:30,434 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 26.86s (thread pool)
INFO:     127.0.0.1:60556 - "POST /api/sessions/a316968a-2cd3-42f0-a782-8ff00fbccfd7/messages HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:14:19,702 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [33480]
INFO:     Started server process [36886]
INFO:     Waiting for application startup.
2025-11-14 13:14:21,304 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:14:21,304 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:14:21,307 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:14:21,307 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:14:21,308 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:14:21,309 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:14:21,309 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:14:21,309 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:14:21,309 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:14:21,309 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:14:21,309 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:14:21,309 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:14:22,218 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [36886]
INFO:     Started server process [37063]
INFO:     Waiting for application startup.
2025-11-14 13:14:23,203 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:14:23,203 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:14:23,204 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:14:23,204 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:14:23,205 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:14:23,206 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:14:23,207 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:14:23,207 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:14:23,208 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:14:23,208 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:14:23,208 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:14:23,208 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:14:30,282 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [37063]
INFO:     Started server process [37828]
INFO:     Waiting for application startup.
2025-11-14 13:14:31,651 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:14:31,651 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:14:31,653 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:14:31,653 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:14:31,654 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:14:31,655 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:14:31,655 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:14:31,657 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:14:31,658 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:14:31,658 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:14:31,658 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:14:31,658 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:17:45,084 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [37828]
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Started server process [42207]
INFO:     Waiting for application startup.
2025-11-14 13:17:47,098 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:17:47,098 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:17:47,101 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:17:47,101 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:17:47,102 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:17:47,103 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:17:47,103 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:17:47,103 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:17:47,104 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:17:47,104 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:17:47,104 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:17:47,104 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:18:00,164 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [42207]
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Started server process [46841]
INFO:     Waiting for application startup.
2025-11-14 13:18:02,002 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:18:02,002 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:18:02,006 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:18:02,007 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:18:02,007 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:18:02,007 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:18:02,007 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:18:02,007 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:18:02,008 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:18:02,008 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:18:02,008 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:18:02,009 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:18:02,010 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:18:02,010 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:18:02,011 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:18:02,011 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:18:02,011 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:18:02,011 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:18:03,354 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:18:03,354 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60806 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:18:03,362 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:18:03,363 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:18:03,364 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:18:03,365 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:18:03,365 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:18:03,366 - backend.api.routes.sessions - ERROR - Error in send_message for session db60dfab-bb93-42f1-a2dc-6e18ed5c6291: 'str' object has no attribute 'objective_id'
INFO:     127.0.0.1:60808 - "POST /api/sessions/db60dfab-bb93-42f1-a2dc-6e18ed5c6291/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:18:15,551 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [46841]
Process SpawnProcess-18:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 14, in <module>
    from ...pocketflow.lesson_agent import LessonAgent
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/__init__.py", line 8, in <module>
    from .lesson_agent import LessonAgent
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/lesson_agent.py", line 1072
    ]
    ^
SyntaxError: unmatched ']'
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
Process SpawnProcess-19:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 14, in <module>
    from ...pocketflow.lesson_agent import LessonAgent
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/__init__.py", line 8, in <module>
    from .lesson_agent import LessonAgent
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/lesson_agent.py", line 1072
    ]
    ^
SyntaxError: unmatched ']'
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
Process SpawnProcess-20:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 14, in <module>
    from ...pocketflow.lesson_agent import LessonAgent
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/__init__.py", line 8, in <module>
    from .lesson_agent import LessonAgent
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/lesson_agent.py", line 1899
    """Build context dictionary for lesson generation with RAG context support"""
IndentationError: expected an indented block after function definition on line 1898
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Started server process [51782]
INFO:     Waiting for application startup.
2025-11-14 13:18:31,026 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:18:31,026 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:18:31,029 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:18:31,029 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:18:31,030 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:18:31,031 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:18:31,031 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:18:31,032 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:18:31,032 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:18:31,032 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:18:31,032 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:18:31,032 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:18:32,551 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [51782]
INFO:     Started server process [52358]
INFO:     Waiting for application startup.
2025-11-14 13:18:33,721 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:18:33,722 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:18:33,722 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:18:33,722 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:18:33,723 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:18:33,724 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:18:33,724 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:18:33,724 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:18:33,725 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:18:33,725 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:18:33,725 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:18:33,725 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:18:35,438 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [52358]
Process SpawnProcess-23:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 66
    return SessionResponse(
    ^
SyntaxError: 'return' outside function
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Started server process [53558]
INFO:     Waiting for application startup.
2025-11-14 13:18:41,361 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:18:41,361 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:18:41,364 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:18:41,364 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:18:41,364 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:18:41,364 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:18:41,365 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:18:41,366 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:18:41,366 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:18:41,366 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:18:41,366 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:18:41,366 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:18:43,086 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [53558]
INFO:     Started server process [53723]
INFO:     Waiting for application startup.
2025-11-14 13:18:44,014 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:18:44,014 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:18:44,017 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:18:44,018 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:18:44,018 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:18:44,018 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:18:44,018 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:18:44,019 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:18:44,019 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:18:44,019 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:18:44,019 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:18:44,019 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:18:44,019 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:18:44,020 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:18:44,020 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:18:44,020 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:18:44,020 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:18:44,020 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:19:01,669 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [53723]
INFO:     Started server process [54464]
INFO:     Waiting for application startup.
2025-11-14 13:19:03,165 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:19:03,165 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:19:03,168 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:19:03,168 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:19:03,169 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:19:03,170 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:19:03,170 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:19:03,171 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:19:03,171 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:19:03,171 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:19:03,171 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:19:03,171 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:19:09,533 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [54464]
INFO:     Started server process [55333]
INFO:     Waiting for application startup.
2025-11-14 13:19:11,097 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:19:11,097 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:19:11,101 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:19:11,101 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:19:11,102 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:19:11,102 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:19:11,103 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:19:11,103 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:19:11,103 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:19:11,103 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:19:11,103 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:19:11,104 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:19:11,104 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:19:11,105 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:19:11,105 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:19:11,105 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:19:11,105 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:19:11,106 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:19:12,988 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:19:12,989 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60853 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:19:12,997 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:19:12,997 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:19:12,998 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:19:12,998 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:19:12,998 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:19:12,999 - backend.api.routes.sessions - ERROR - Error in send_message for session 7a738aa2-a2bd-489e-95c2-07fe0894fc0d: 'str' object has no attribute 'objective_id'
INFO:     127.0.0.1:60855 - "POST /api/sessions/7a738aa2-a2bd-489e-95c2-07fe0894fc0d/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'test_api_objectives.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:19:17,985 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [55333]
WARNING:  WatchFiles detected changes in 'test_api_objectives.py'. Reloading...
INFO:     Started server process [56381]
INFO:     Waiting for application startup.
2025-11-14 13:19:19,632 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:19:19,632 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:19:19,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:19:19,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:19:19,634 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:19:19,635 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:19:19,635 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:19:19,636 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:19:19,636 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:19:19,636 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:19:19,636 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:19:19,636 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:19:36,301 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [56381]
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Started server process [57838]
INFO:     Waiting for application startup.
2025-11-14 13:19:38,435 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:19:38,435 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:19:38,438 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:19:38,439 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:19:38,440 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:19:38,440 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:19:38,440 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:19:38,441 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:19:38,441 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:19:38,441 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:19:38,441 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_objectives_in_lesson_generation.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:19:48,771 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [57838]
INFO:     Started server process [58679]
INFO:     Waiting for application startup.
2025-11-14 13:19:49,952 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:19:49,952 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:19:49,954 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:19:49,955 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:19:49,955 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:19:49,955 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:19:49,956 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:19:49,957 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:19:49,957 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:19:49,957 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:19:49,957 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:19:49,957 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:19:56,161 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:19:56,164 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60882 - "POST /api/sessions HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_objectives_in_lesson_generation.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:19:58,531 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [58679]
INFO:     Started server process [58866]
INFO:     Waiting for application startup.
2025-11-14 13:20:00,149 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:20:00,149 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:20:00,150 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:20:00,150 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:20:00,151 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:20:00,152 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:20:00,152 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:20:00,152 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:20:00,153 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:20:00,153 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:20:00,153 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:20:00,153 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:20:01,539 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:20:01,540 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60888 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:20:01,546 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:20:01,546 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:20:01,546 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:20:01,547 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:20:01,547 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:20:01,548 - backend.api.routes.sessions - INFO - Conversation history saved for session 6f59fe04-1d45-473e-8667-8c81a102818a
2025-11-14 13:20:03,384 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.84s
2025-11-14 13:20:18,250 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.87s
2025-11-14 13:20:18,253 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 16.70s (thread pool)
2025-11-14 13:20:18,254 - backend.api.routes.sessions - ERROR - Error in send_message for session 6f59fe04-1d45-473e-8667-8c81a102818a: object str can't be used in 'await' expression
INFO:     127.0.0.1:60890 - "POST /api/sessions/6f59fe04-1d45-473e-8667-8c81a102818a/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:20:43,200 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [58866]
INFO:     Started server process [61191]
INFO:     Waiting for application startup.
2025-11-14 13:20:44,806 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:20:44,806 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:20:44,809 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:20:44,810 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:20:44,811 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:20:44,811 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:20:44,811 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:20:44,811 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:20:44,811 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:20:44,812 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:20:44,812 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:20:44,812 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:20:44,813 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:20:44,813 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:20:44,814 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:20:44,814 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:20:44,814 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:20:44,814 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:20:45,938 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [61191]
INFO:     Started server process [61629]
INFO:     Waiting for application startup.
2025-11-14 13:20:47,338 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:20:47,338 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:20:47,339 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:20:47,339 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:20:47,340 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:20:47,341 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:20:47,341 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:20:47,341 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:20:47,341 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:20:47,341 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:20:47,341 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:20:52,595 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [61629]
INFO:     Started server process [62772]
INFO:     Waiting for application startup.
2025-11-14 13:20:53,922 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:20:53,922 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:20:53,925 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:20:53,926 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:20:53,926 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:20:53,926 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:20:53,927 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:20:53,927 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:20:53,927 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:20:53,927 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:20:53,927 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:20:53,927 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:20:53,928 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:20:53,928 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:20:53,929 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:20:53,929 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:20:53,929 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:20:53,929 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:20:55,240 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [62772]
INFO:     Started server process [63041]
INFO:     Waiting for application startup.
2025-11-14 13:20:56,553 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:20:56,553 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:20:56,554 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:20:56,555 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:20:56,555 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:20:56,555 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:20:56,555 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:20:56,556 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:20:56,556 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:20:56,556 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:20:56,556 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:20:56,556 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:21:05,851 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [63041]
INFO:     Started server process [63883]
INFO:     Waiting for application startup.
2025-11-14 13:21:06,613 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:21:06,613 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:21:06,614 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:21:06,614 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:21:06,615 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:21:06,616 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:21:06,616 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:21:06,616 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:21:06,616 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:21:06,616 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:21:06,616 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:21:07,947 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:07,947 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60923 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:21:07,952 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:07,952 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:07,952 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:07,952 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:07,953 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:21:07,953 - backend.api.routes.sessions - ERROR - Error in send_message for session 371f6ec5-a936-4d0f-9da0-2f938bc6947b: 'str' object has no attribute 'objective_id'
INFO:     127.0.0.1:60925 - "POST /api/sessions/371f6ec5-a936-4d0f-9da0-2f938bc6947b/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:21:22,983 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [63883]
INFO:     Started server process [66408]
INFO:     Waiting for application startup.
2025-11-14 13:21:23,731 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:21:23,731 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:21:23,732 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:21:23,732 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:21:23,733 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:21:23,734 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:21:23,734 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:21:23,734 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:21:23,734 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:21:23,734 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:21:23,734 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:21:23,734 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:21:24,765 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:24,766 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60935 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:21:24,770 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:24,770 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:24,770 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:24,771 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:24,771 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:21:24,771 - backend.api.routes.sessions - ERROR - Error in send_message for session d0caa2c9-d523-42bc-8164-c0b0e2f4e4c7: 'str' object has no attribute 'objective_id'
INFO:     127.0.0.1:60937 - "POST /api/sessions/d0caa2c9-d523-42bc-8164-c0b0e2f4e4c7/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'debug_objectives.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:21:28,884 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [66408]
INFO:     Started server process [67501]
INFO:     Waiting for application startup.
2025-11-14 13:21:29,631 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:21:29,631 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:21:29,632 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:21:29,632 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:21:29,633 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:21:29,634 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:21:29,634 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:21:29,634 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:21:29,635 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:21:29,635 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:21:29,635 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:21:29,635 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:21:30,374 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:30,374 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60943 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:21:30,380 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:30,380 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:30,380 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:30,380 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:30,381 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:21:30,381 - backend.api.routes.sessions - ERROR - Error in send_message for session 2ac2c3b1-e4c4-4a41-92d3-adf9e8d74603: 'str' object has no attribute 'objective_id'
INFO:     127.0.0.1:60945 - "POST /api/sessions/2ac2c3b1-e4c4-4a41-92d3-adf9e8d74603/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:21:32,866 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [67501]
INFO:     Started server process [68595]
INFO:     Waiting for application startup.
2025-11-14 13:21:33,632 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:21:33,632 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:21:33,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:21:33,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:21:33,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:21:33,633 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:21:33,634 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:21:33,634 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:21:33,634 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:21:33,634 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:21:33,634 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:21:33,634 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:21:33,635 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:21:33,635 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:21:33,635 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:21:33,635 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:21:33,635 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:21:33,635 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:21:34,569 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:34,570 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60953 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:21:34,576 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:34,576 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:34,576 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:21:34,577 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:21:34,577 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:21:34,577 - backend.api.routes.sessions - ERROR - Error in send_message for session feb7585e-bd37-4908-9388-9457a1d8eb2c: 'str' object has no attribute 'objective_id'
INFO:     127.0.0.1:60955 - "POST /api/sessions/feb7585e-bd37-4908-9388-9457a1d8eb2c/messages HTTP/1.1" 500 Internal Server Error
2025-11-14 13:22:09,636 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,636 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60968 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:22:09,659 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,660 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60971 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
2025-11-14 13:22:09,662 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,663 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60977 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:60969 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:22:09,668 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,668 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:22:09,702 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,703 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60976 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:60973 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:60981 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:60983 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:60988 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:60991 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:60985 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 13:22:09,721 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,721 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:22:09,723 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,723 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60997 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:61000 - "GET /api/standards HTTP/1.1" 200 OK
2025-11-14 13:22:09,742 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:09,743 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:60998 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:60985 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:61003 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 13:22:33,473 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:33,474 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:22:33,511 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:33,511 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:22:33,532 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:33,532 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61059 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61060 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61063 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61066 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:61056 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61064 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:61068 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 13:22:33,541 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:22:33,541 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61071 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:23:15,870 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [68595]
INFO:     Started server process [73378]
INFO:     Waiting for application startup.
2025-11-14 13:23:16,596 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:23:16,596 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:23:16,597 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:23:16,597 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:23:16,598 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:23:16,599 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:23:16,599 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:23:16,599 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:23:16,599 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:23:16,599 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:23:16,599 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:23:18,566 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:23:18,566 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61084 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:23:18,570 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:23:18,571 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:23:18,571 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:23:18,571 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:23:18,571 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:23:18,572 - backend.api.routes.sessions - ERROR - Error in send_message for session 99f799c4-635f-4f05-aa1b-361c9cf201c6: 'str' object has no attribute 'objective_id'
2025-11-14 13:23:18,572 - backend.api.routes.sessions - ERROR - Full traceback: Traceback (most recent call last):
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 473, in send_message
    _persist_user_message(session_id, agent, session_repo, request.message)
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 337, in _persist_user_message
    agent_state_json = agent.serialize_state()
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/lesson_agent.py", line 2028, in serialize_state
    serializable_reqs[key] = [
                             ^
  File "/Users/cnowlin/Developer/pocket_musec/backend/pocketflow/lesson_agent.py", line 2030, in <listcomp>
    "objective_id": obj.objective_id,
                    ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'objective_id'

INFO:     127.0.0.1:61086 - "POST /api/sessions/99f799c4-635f-4f05-aa1b-361c9cf201c6/messages HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:23:46,294 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [73378]
INFO:     Started server process [75300]
INFO:     Waiting for application startup.
2025-11-14 13:23:47,019 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:23:47,019 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:23:47,019 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:23:47,020 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:23:47,020 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:23:47,020 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:23:47,020 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:23:47,020 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:23:47,020 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:23:47,021 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:23:47,021 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:23:47,021 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:23:47,021 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:23:47,021 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:23:47,022 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:23:47,022 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:23:47,022 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:23:47,022 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:23:53,846 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:23:53,846 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61096 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:23:53,851 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:23:53,851 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:23:53,851 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:23:53,851 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:23:53,851 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:23:53,853 - backend.api.routes.sessions - INFO - Conversation history saved for session 2a495721-7c43-43b1-84f4-c51ed9b2d796
2025-11-14 13:23:55,840 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.99s
2025-11-14 13:24:07,016 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.39s
2025-11-14 13:24:07,017 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 13.16s (thread pool)
INFO:     127.0.0.1:61098 - "POST /api/sessions/2a495721-7c43-43b1-84f4-c51ed9b2d796/messages HTTP/1.1" 200 OK
2025-11-14 13:24:08,449 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:08,450 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61105 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:24:08,454 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:08,454 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:24:08,454 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:08,454 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:24:08,454 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:24:08,455 - backend.api.routes.sessions - INFO - Conversation history saved for session bf6a2d7f-8809-4049-9bbd-578c68166674
2025-11-14 13:24:10,292 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.84s
2025-11-14 13:24:22,479 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.20s
2025-11-14 13:24:22,479 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 14.02s (thread pool)
INFO:     127.0.0.1:61107 - "POST /api/sessions/bf6a2d7f-8809-4049-9bbd-578c68166674/messages HTTP/1.1" 200 OK
2025-11-14 13:24:23,491 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:23,491 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:24:23,491 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:23,491 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:24:23,491 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:24:23,491 - root - WARNING - Failed to restore agent state: string indices must be integers, not 'str'
2025-11-14 13:24:23,491 - backend.api.routes.sessions - INFO - Restored 2 messages to conversation history
2025-11-14 13:24:23,493 - backend.api.routes.sessions - INFO - Conversation history saved for session bf6a2d7f-8809-4049-9bbd-578c68166674
2025-11-14 13:24:38,863 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.43s
2025-11-14 13:24:38,863 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 11.43s (thread pool)
INFO:     127.0.0.1:61112 - "POST /api/sessions/bf6a2d7f-8809-4049-9bbd-578c68166674/messages HTTP/1.1" 200 OK
2025-11-14 13:24:38,869 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:38,870 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61117 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:24:38,873 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:38,873 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:24:38,873 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:38,873 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:24:38,873 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:24:38,874 - backend.api.routes.sessions - INFO - Conversation history saved for session 00481d78-6a10-476f-89ca-72c7634ff817
2025-11-14 13:24:40,796 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.92s
2025-11-14 13:24:56,077 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 13.19s
2025-11-14 13:24:56,077 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 17.20s (thread pool)
INFO:     127.0.0.1:61119 - "POST /api/sessions/00481d78-6a10-476f-89ca-72c7634ff817/messages HTTP/1.1" 200 OK
2025-11-14 13:24:59,824 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:24:59,824 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61125 - "POST /api/sessions HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'debug_session.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:25:57,797 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [75300]
INFO:     Started server process [88722]
INFO:     Waiting for application startup.
2025-11-14 13:25:58,509 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:25:58,509 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:25:58,510 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:25:58,510 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:25:58,510 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:25:58,510 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:25:58,511 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:25:58,511 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:25:58,511 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:25:58,511 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:25:58,511 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:25:58,511 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:25:58,512 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:25:58,512 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:25:58,512 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:25:58,512 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:25:58,512 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:25:58,512 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:25:59,244 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:25:59,245 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61136 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:25:59,249 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:25:59,249 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61138 - "GET /api/sessions/e3548a5b-443d-4d33-bab8-a3be90eb0555 HTTP/1.1" 200 OK
2025-11-14 13:26:04,797 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:26:04,797 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61141 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:26:04,802 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:26:04,802 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:26:04,802 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:26:04,802 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:26:04,802 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:26:04,804 - backend.api.routes.sessions - INFO - Conversation history saved for session f6907ef0-d536-4fe1-813c-e1fd84ebb41a
2025-11-14 13:26:07,531 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.73s
2025-11-14 13:26:24,440 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 13.89s
2025-11-14 13:26:24,441 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 19.64s (thread pool)
INFO:     127.0.0.1:61143 - "POST /api/sessions/f6907ef0-d536-4fe1-813c-e1fd84ebb41a/messages HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_objectives_edge_cases.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:27:28,685 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [88722]
INFO:     Started server process [99058]
INFO:     Waiting for application startup.
2025-11-14 13:27:29,401 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:27:29,401 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:27:29,402 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:27:29,402 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:27:29,402 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:27:29,402 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:27:29,402 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:27:29,402 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:27:29,403 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:27:29,403 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:27:29,403 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:27:29,403 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:27:29,403 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:27:29,404 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:27:29,404 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:27:29,404 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:27:29,404 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:27:29,404 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:27:30,091 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:30,092 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61162 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:27:30,096 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:30,096 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:27:30,096 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:30,097 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:27:30,097 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:27:30,098 - backend.api.routes.sessions - INFO - Conversation history saved for session c2af5f9f-ee25-4c41-bb99-9b4fb963f8ab
2025-11-14 13:27:33,959 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 3.86s
2025-11-14 13:27:41,434 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 5.58s
2025-11-14 13:27:41,435 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 11.34s (thread pool)
INFO:     127.0.0.1:61164 - "POST /api/sessions/c2af5f9f-ee25-4c41-bb99-9b4fb963f8ab/messages HTTP/1.1" 200 OK
2025-11-14 13:27:41,442 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:41,442 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61169 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:27:41,446 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:41,446 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:27:41,447 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:41,447 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:27:41,447 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:27:41,448 - backend.api.routes.sessions - INFO - Conversation history saved for session ee52ae72-05f4-4530-8199-a825abee8304
2025-11-14 13:27:47,166 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 5.72s
2025-11-14 13:27:57,115 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 8.43s
2025-11-14 13:27:57,115 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 15.67s (thread pool)
INFO:     127.0.0.1:61171 - "POST /api/sessions/ee52ae72-05f4-4530-8199-a825abee8304/messages HTTP/1.1" 200 OK
2025-11-14 13:27:57,122 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:57,122 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61177 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:27:57,126 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:57,126 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:27:57,126 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:27:57,126 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:27:57,126 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:27:57,128 - backend.api.routes.sessions - INFO - Conversation history saved for session b944d3ce-8a4d-40d0-b0e9-c00481625edb
2025-11-14 13:27:59,352 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.22s
2025-11-14 13:28:06,353 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 5.11s
2025-11-14 13:28:06,353 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 9.23s (thread pool)
INFO:     127.0.0.1:61179 - "POST /api/sessions/b944d3ce-8a4d-40d0-b0e9-c00481625edb/messages HTTP/1.1" 200 OK
2025-11-14 13:28:06,360 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:06,360 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61184 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:28:06,364 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:06,364 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:28:06,364 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:06,364 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:28:06,364 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:28:06,366 - backend.api.routes.sessions - INFO - Conversation history saved for session a8c8df8a-dc79-4ee0-a416-e86d486994f7
2025-11-14 13:28:08,670 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.30s
2025-11-14 13:28:22,205 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.75s
2025-11-14 13:28:22,205 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 15.84s (thread pool)
INFO:     127.0.0.1:61186 - "POST /api/sessions/a8c8df8a-dc79-4ee0-a416-e86d486994f7/messages HTTP/1.1" 200 OK
2025-11-14 13:28:22,211 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:22,212 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61191 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:28:22,215 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:22,215 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:28:22,216 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:22,216 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:28:22,216 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:28:22,217 - backend.api.routes.sessions - INFO - Conversation history saved for session 5cea481e-c1a4-46f2-a6c2-c1c66a318345
2025-11-14 13:28:24,032 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.81s
WARNING:  WatchFiles detected changes in 'quick_edge_test.py'. Reloading...
2025-11-14 13:28:36,334 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.27s
2025-11-14 13:28:36,334 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 14.12s (thread pool)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:28:36,441 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [99058]
INFO:     Started server process [3141]
INFO:     Waiting for application startup.
2025-11-14 13:28:37,150 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:28:37,150 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:28:37,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:28:37,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:28:37,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:28:37,151 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:28:37,152 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:28:37,153 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:28:37,153 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:28:37,153 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:28:37,153 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:28:37,153 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:28:44,934 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:44,934 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61204 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:28:44,939 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:44,939 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61206 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:28:44,942 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:44,943 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61208 - "POST /api/sessions HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_focused_edge_cases.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:28:50,499 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [3141]
INFO:     Started server process [9303]
INFO:     Waiting for application startup.
2025-11-14 13:28:51,207 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:28:51,207 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:28:51,208 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:28:51,208 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:28:51,208 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:28:51,208 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:28:51,209 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:28:51,210 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:28:51,210 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:28:51,210 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:28:51,210 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:28:51,210 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:28:52,064 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:52,064 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61212 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:28:52,068 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:52,068 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:28:52,069 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:28:52,069 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:28:52,069 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:28:52,071 - backend.api.routes.sessions - INFO - Conversation history saved for session 72cc8da9-c3a6-4d2d-8728-da40f23b635f
2025-11-14 13:28:53,859 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.79s
2025-11-14 13:29:05,927 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.10s
2025-11-14 13:29:05,928 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 13.86s (thread pool)
INFO:     127.0.0.1:61214 - "POST /api/sessions/72cc8da9-c3a6-4d2d-8728-da40f23b635f/messages HTTP/1.1" 200 OK
2025-11-14 13:29:06,936 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:06,937 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61220 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:06,941 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:06,941 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:29:06,941 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:06,941 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:29:06,941 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:29:06,943 - backend.api.routes.sessions - INFO - Conversation history saved for session 35bcba97-f62c-4479-95ea-afa5b10d61d6
2025-11-14 13:29:08,678 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.74s
2025-11-14 13:29:24,746 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 13.56s
2025-11-14 13:29:24,746 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 17.80s (thread pool)
INFO:     127.0.0.1:61222 - "POST /api/sessions/35bcba97-f62c-4479-95ea-afa5b10d61d6/messages HTTP/1.1" 200 OK
2025-11-14 13:29:25,758 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:25,758 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61227 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:25,762 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:25,763 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:29:25,763 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:25,763 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:29:25,763 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:29:25,764 - backend.api.routes.sessions - INFO - Conversation history saved for session 9ca755d9-c7d7-4565-91bc-7d65f0672377
2025-11-14 13:29:28,037 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.27s
2025-11-14 13:29:40,863 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.12s
2025-11-14 13:29:40,864 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 15.10s (thread pool)
INFO:     127.0.0.1:61229 - "POST /api/sessions/9ca755d9-c7d7-4565-91bc-7d65f0672377/messages HTTP/1.1" 200 OK
2025-11-14 13:29:41,876 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:41,876 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61235 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:41,880 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:41,881 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:29:41,881 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:41,881 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:29:41,881 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:29:41,882 - backend.api.routes.sessions - INFO - Conversation history saved for session ca4c9a04-cc76-4997-b5ac-c0db768068c9
2025-11-14 13:29:43,802 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.92s
2025-11-14 13:29:55,734 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.24s
2025-11-14 13:29:55,735 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 13.85s (thread pool)
WARNING:  WatchFiles detected changes in 'test_efficient_edge_cases.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:29:56,354 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [9303]
INFO:     Started server process [11098]
INFO:     Waiting for application startup.
2025-11-14 13:29:57,049 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:29:57,049 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:29:57,050 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:29:57,050 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:29:57,051 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:29:57,052 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:29:57,052 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:29:57,052 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:29:57,052 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:29:57,052 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:29:57,052 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:29:57,805 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:57,806 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61244 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:57,810 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:57,810 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61246 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:57,814 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:57,814 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61248 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:57,818 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:57,818 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61250 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:57,822 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:57,822 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61252 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:29:57,825 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:29:57,826 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61254 - "POST /api/sessions HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_final_comprehensive.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:30:03,020 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [11098]
INFO:     Started server process [13426]
INFO:     Waiting for application startup.
2025-11-14 13:30:03,730 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:30:03,730 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:30:03,731 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:30:03,731 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:30:03,731 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:30:03,732 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:30:03,733 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:30:03,733 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:30:03,733 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:30:03,733 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:30:03,733 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:30:03,733 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:30:04,870 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:04,871 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61258 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:30:04,875 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:04,875 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:04,875 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:04,876 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:04,876 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:30:04,877 - backend.api.routes.sessions - INFO - Conversation history saved for session 873ffb4c-7fb3-4193-90f8-1701f55a3f34
2025-11-14 13:30:11,245 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 6.37s
2025-11-14 13:30:22,664 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.82s
2025-11-14 13:30:22,664 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 17.79s (thread pool)
INFO:     127.0.0.1:61260 - "POST /api/sessions/873ffb4c-7fb3-4193-90f8-1701f55a3f34/messages HTTP/1.1" 200 OK
2025-11-14 13:30:24,677 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:24,677 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61265 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:30:24,681 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:24,681 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:24,681 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:24,682 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:24,682 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:30:24,683 - backend.api.routes.sessions - INFO - Conversation history saved for session 141ff76e-def8-457e-b93a-a5632fb9da38
2025-11-14 13:30:26,401 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.72s
2025-11-14 13:30:36,963 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 7.54s
2025-11-14 13:30:36,963 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 12.28s (thread pool)
INFO:     127.0.0.1:61267 - "POST /api/sessions/141ff76e-def8-457e-b93a-a5632fb9da38/messages HTTP/1.1" 200 OK
2025-11-14 13:30:38,975 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:38,975 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61272 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:30:38,979 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:38,979 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:38,979 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:38,980 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:38,980 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:30:38,981 - backend.api.routes.sessions - INFO - Conversation history saved for session 8d181039-e3d3-4f81-aa0d-8e54c31d6cfa
2025-11-14 13:30:41,761 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.78s
2025-11-14 13:30:51,988 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 8.46s
2025-11-14 13:30:51,991 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 13.01s (thread pool)
INFO:     127.0.0.1:61274 - "POST /api/sessions/8d181039-e3d3-4f81-aa0d-8e54c31d6cfa/messages HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'debug_lesson_content.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 13:30:56,746 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [13426]
INFO:     Started server process [16846]
INFO:     Waiting for application startup.
2025-11-14 13:30:57,455 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 13:30:57,455 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 13:30:57,455 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 13:30:57,456 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 13:30:57,456 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 13:30:57,456 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 13:30:57,456 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 13:30:57,456 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 13:30:57,456 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 13:30:57,457 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 13:30:57,457 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 13:30:57,457 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 13:30:57,457 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 13:30:57,457 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 13:30:57,458 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 13:30:57,458 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 13:30:57,458 - backend.api.main - INFO - Database migrations completed
2025-11-14 13:30:57,458 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 13:30:58,257 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:58,257 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61283 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:30:58,262 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:58,262 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:58,262 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:30:58,262 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:30:58,262 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:30:58,264 - backend.api.routes.sessions - INFO - Conversation history saved for session fd81cafb-52af-442b-93bd-72977597558f
2025-11-14 13:31:00,604 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.34s
2025-11-14 13:31:13,111 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.81s
2025-11-14 13:31:13,112 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 14.85s (thread pool)
INFO:     127.0.0.1:61285 - "POST /api/sessions/fd81cafb-52af-442b-93bd-72977597558f/messages HTTP/1.1" 200 OK
2025-11-14 13:44:01,313 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,315 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:44:01,322 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,323 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61308 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:44:01,358 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,359 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61314 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61315 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61317 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61318 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:61316 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:61324 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 13:44:01,383 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,383 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:44:01,384 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,385 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61329 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 13:44:01,417 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,417 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:44:01,424 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,425 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61330 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61332 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61336 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:61337 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61338 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:61341 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 13:44:01,443 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:01,443 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61344 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:61324 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 13:44:17,749 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:17,751 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61347 - "GET /api/standards?grade_level=K HTTP/1.1" 200 OK
2025-11-14 13:44:19,865 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:19,866 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:44:19,869 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:19,870 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61350 - "PUT /api/sessions/d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a HTTP/1.1" 200 OK
INFO:     127.0.0.1:61353 - "GET /api/standards?grade_level=K&strand_code=CREATE HTTP/1.1" 200 OK
2025-11-14 13:44:19,884 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:19,884 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:44:19,885 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:44:19,885 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:44:19,886 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:44:19,891 - backend.api.routes.sessions - INFO - Conversation history saved for session d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a
2025-11-14 13:44:23,025 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 3.13s
2025-11-14 13:44:41,916 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 13.00s
2025-11-14 13:44:41,917 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 22.03s (thread pool)
INFO:     127.0.0.1:61356 - "POST /api/sessions/d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a/messages/stream HTTP/1.1" 200 OK
2025-11-14 13:45:03,943 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:45:03,944 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:45:03,945 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:45:03,945 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:45:03,945 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:45:03,946 - backend.api.routes.sessions - INFO - Restored 3 messages to conversation history
2025-11-14 13:45:03,951 - backend.api.routes.sessions - INFO - Conversation history saved for session d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a
2025-11-14 13:45:03,951 - backend.pocketflow.lesson_agent - INFO - Searching for teaching strategies with query: teaching strategies pedagogical approaches instructional methods activities
2025-11-14 13:45:05,570 - backend.pocketflow.lesson_agent - INFO - No teaching strategies found in standards
2025-11-14 13:45:05,571 - backend.pocketflow.lesson_agent - INFO - Searching for assessment guidance with query: assessment strategies evaluation methods rubrics formative assessment
2025-11-14 13:45:07,525 - backend.pocketflow.lesson_agent - INFO - No assessment guidance found in standards
2025-11-14 13:45:07,525 - backend.pocketflow.lesson_agent - INFO - No musical topics provided for web search
2025-11-14 13:45:36,721 - backend.pocketflow.lesson_agent - INFO - LLM lesson plan generation took 29.20s
2025-11-14 13:45:36,722 - backend.pocketflow.lesson_agent - INFO - Lesson plan generated in 32.77s (thread pool)
INFO:     127.0.0.1:61363 - "POST /api/sessions/d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a/messages/stream HTTP/1.1" 200 OK
2025-11-14 13:50:30,107 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:50:30,107 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:50:30,108 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 13:50:30,108 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 13:50:30,109 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 13:50:30,109 - backend.api.routes.sessions - INFO - Restored 6 messages to conversation history
2025-11-14 13:50:30,115 - backend.api.routes.sessions - INFO - Conversation history saved for session d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a
INFO:     127.0.0.1:61375 - "POST /api/sessions/d3e8aff1-0d3a-4d82-9288-c7bf34a0c63a/messages/stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:61410 - "GET /api/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:61417 - "GET / HTTP/1.1" 200 OK
2025-11-14 14:07:10,340 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:10,341 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:10,342 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:10,343 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:10,363 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:10,363 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61431 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61433 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61436 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61438 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61440 - "GET /api/standards?grade_level=K&strand_code=CREATE HTTP/1.1" 200 OK
INFO:     127.0.0.1:61437 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:61443 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 14:07:10,382 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:10,383 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61445 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 14:07:13,115 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:13,116 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:13,136 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:13,136 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:13,138 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:13,138 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61456 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61457 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61462 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61463 - "GET /api/standards?grade_level=K&strand_code=CREATE HTTP/1.1" 200 OK
INFO:     127.0.0.1:61455 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61459 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:61443 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 14:07:13,147 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:13,147 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61466 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 14:07:20,992 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:20,993 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:21,012 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:21,012 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:21,013 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:21,013 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61476 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61478 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61482 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61484 - "GET /api/standards?grade_level=K&strand_code=CREATE HTTP/1.1" 200 OK
INFO:     127.0.0.1:61475 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61480 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 14:07:21,023 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:21,023 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61486 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:61489 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 14:07:25,439 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,439 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:25,458 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,459 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:25,476 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,476 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61504 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61505 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61507 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:61508 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:61503 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61506 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 14:07:25,483 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,484 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:07:25,486 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,486 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61486 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:61511 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 14:07:25,497 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,498 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61517 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:61522 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:61523 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:61525 - "GET /api/drafts HTTP/1.1" 200 OK
2025-11-14 14:07:25,524 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,525 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61526 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:61529 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:61486 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 14:07:25,529 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:07:25,530 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:61532 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_ui_objective_integration.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 14:07:32,950 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [16846]
INFO:     Started server process [55479]
INFO:     Waiting for application startup.
2025-11-14 14:07:33,705 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 14:07:33,705 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 14:07:33,705 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 14:07:33,705 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 14:07:33,706 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 14:07:33,706 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 14:07:33,706 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 14:07:33,706 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 14:07:33,706 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 14:07:33,706 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 14:07:33,707 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 14:07:33,707 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 14:07:33,707 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 14:07:33,707 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 14:07:33,708 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 14:07:33,708 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 14:07:33,708 - backend.api.main - INFO - Database migrations completed
2025-11-14 14:07:33,708 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_ui_objective_integration.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 14:07:37,146 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [55479]
INFO:     Started server process [57050]
INFO:     Waiting for application startup.
2025-11-14 14:07:37,890 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 14:07:37,890 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 14:07:37,891 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 14:07:37,891 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 14:07:37,891 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 14:07:37,891 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 14:07:37,891 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 14:07:37,892 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 14:07:37,892 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 14:07:37,892 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 14:07:37,892 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 14:07:37,892 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 14:07:37,892 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 14:07:37,893 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 14:07:37,893 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 14:07:37,893 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 14:07:37,893 - backend.api.main - INFO - Database migrations completed
2025-11-14 14:07:37,893 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_complete_ui_integration.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 14:07:55,575 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [57050]
INFO:     Started server process [66309]
INFO:     Waiting for application startup.
2025-11-14 14:07:56,319 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 14:07:56,319 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 14:07:56,320 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 14:07:56,320 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 14:07:56,320 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 14:07:56,320 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 14:07:56,320 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 14:07:56,320 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 14:07:56,321 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 14:07:56,321 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 14:07:56,321 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 14:07:56,321 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 14:07:56,321 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 14:07:56,321 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 14:07:56,322 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 14:07:56,322 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 14:07:56,322 - backend.api.main - INFO - Database migrations completed
2025-11-14 14:07:56,322 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'verify_ui_fixes.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 14:08:12,177 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [66309]
INFO:     Started server process [70092]
INFO:     Waiting for application startup.
2025-11-14 14:08:12,909 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 14:08:12,909 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 14:08:12,909 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 14:08:12,910 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 14:08:12,910 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 14:08:12,910 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 14:08:12,910 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 14:08:12,910 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 14:08:12,910 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 14:08:12,911 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 14:08:12,911 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 14:08:12,911 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 14:08:12,911 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 14:08:12,912 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 14:08:12,912 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 14:08:12,912 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 14:08:12,912 - backend.api.main - INFO - Database migrations completed
2025-11-14 14:08:12,912 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:63244 - "GET /health HTTP/1.1" 200 OK
2025-11-14 14:22:16,133 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,134 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:22:16,154 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,155 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:22:16,172 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,172 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63260 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63262 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63263 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63265 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63259 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 14:22:16,178 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,179 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63264 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 14:22:16,207 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,208 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:22:16,215 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,216 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63272 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 14:22:16,231 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,232 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63277 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63270 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63278 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63280 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63285 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:63282 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:63288 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:63282 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 14:22:16,242 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:22:16,242 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63293 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 14:23:08,850 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:23:08,851 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63296 - "GET /api/standards?strand_code=CREATE HTTP/1.1" 200 OK
2025-11-14 14:23:10,087 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:23:10,087 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63299 - "GET /api/standards?grade_level=3&strand_code=CREATE HTTP/1.1" 200 OK
2025-11-14 14:23:11,764 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:23:11,765 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63302 - "GET /api/standards?grade_level=2&strand_code=CREATE HTTP/1.1" 200 OK
2025-11-14 14:23:18,884 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:23:18,885 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63305 - "PUT /api/sessions/2bf0056e-7593-4d2a-bcc6-fb25082f3bc2 HTTP/1.1" 200 OK
2025-11-14 14:23:18,897 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:23:18,898 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:23:18,898 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:23:18,899 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:23:18,899 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 14:23:18,904 - backend.api.routes.sessions - INFO - Conversation history saved for session 2bf0056e-7593-4d2a-bcc6-fb25082f3bc2
2025-11-14 14:23:21,702 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.80s
2025-11-14 14:23:36,949 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 13.39s
2025-11-14 14:23:36,950 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 18.05s (thread pool)
INFO:     127.0.0.1:63308 - "POST /api/sessions/2bf0056e-7593-4d2a-bcc6-fb25082f3bc2/messages/stream HTTP/1.1" 200 OK
2025-11-14 14:24:11,164 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:24:11,165 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:24:11,166 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 14:24:11,166 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 14:24:11,167 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 14:24:11,167 - backend.api.routes.sessions - INFO - Restored 3 messages to conversation history
2025-11-14 14:24:11,172 - backend.api.routes.sessions - INFO - Conversation history saved for session 2bf0056e-7593-4d2a-bcc6-fb25082f3bc2
2025-11-14 14:24:11,173 - backend.pocketflow.lesson_agent - INFO - Searching for teaching strategies with query: teaching strategies pedagogical approaches instructional methods activities
2025-11-14 14:24:14,260 - backend.pocketflow.lesson_agent - INFO - No teaching strategies found in standards
2025-11-14 14:24:14,261 - backend.pocketflow.lesson_agent - INFO - Searching for assessment guidance with query: assessment strategies evaluation methods rubrics formative assessment
2025-11-14 14:24:18,259 - backend.pocketflow.lesson_agent - INFO - No assessment guidance found in standards
2025-11-14 14:24:18,259 - backend.pocketflow.lesson_agent - INFO - No musical topics provided for web search
2025-11-14 14:24:48,221 - backend.pocketflow.lesson_agent - INFO - LLM lesson plan generation took 29.96s
2025-11-14 14:24:48,222 - backend.pocketflow.lesson_agent - INFO - Lesson plan generated in 37.05s (thread pool)
INFO:     127.0.0.1:63314 - "POST /api/sessions/2bf0056e-7593-4d2a-bcc6-fb25082f3bc2/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:10:36,100 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:10:36,101 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63401 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:10:36,121 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:10:36,122 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63404 - "GET /api/standards?grade_level=2&strand_code=CREATE HTTP/1.1" 200 OK
2025-11-14 15:10:36,145 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:10:36,146 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63407 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:11:06,720 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:11:06,721 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:11:06,722 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:11:06,722 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:11:06,722 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:11:06,729 - backend.api.routes.sessions - INFO - Conversation history saved for session 14cecf3e-0da5-41e6-a3bb-03bfac1c21cc
2025-11-14 15:11:11,105 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 4.38s
2025-11-14 15:11:25,459 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 12.60s
2025-11-14 15:11:25,461 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 18.73s (thread pool)
INFO:     127.0.0.1:63410 - "POST /api/sessions/14cecf3e-0da5-41e6-a3bb-03bfac1c21cc/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:12:48,360 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:12:48,361 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:12:48,361 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:12:48,362 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:12:48,362 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:12:48,363 - root - WARNING - Failed to restore agent state: string indices must be integers, not 'str'
2025-11-14 15:12:48,363 - backend.api.routes.sessions - INFO - Restored 3 messages to conversation history
2025-11-14 15:12:48,368 - backend.api.routes.sessions - INFO - Conversation history saved for session 14cecf3e-0da5-41e6-a3bb-03bfac1c21cc
2025-11-14 15:12:48,368 - backend.pocketflow.lesson_agent - INFO - Filtering objectives: selected_objectives_str=2.CR.1.1 - Improvise 8-12 beats of rhythmic patterns and melodic patterns., objectives_count=2
2025-11-14 15:12:48,368 - backend.pocketflow.lesson_agent - INFO - Objective 0: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='2.CR.1.1', standard_id='2.CR.1', objective_text='Improvise 8-12 beats of rhythmic patterns and melodic patterns.', file_id=None)
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - INFO - Objective 1: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='2.CR.1.2', standard_id='2.CR.1', objective_text='Notate 8-12 beats of original rhythmic ideas using iconic or standard notation that incorporate grade-level appropriate rhythms.', file_id=None)
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - INFO - Parsed selected_objective_ids: ['2.CR.1.1 - Improvise 8-12 beats of rhythmic patterns and melodic patterns.']
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=2.CR.1.1, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=2.CR.1.2, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - WARNING - No objectives matched selected IDs: ['2.CR.1.1 - Improvise 8-12 beats of rhythmic patterns and melodic patterns.']
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - WARNING - No objectives matched selected IDs: ['2.CR.1.1 - Improvise 8-12 beats of rhythmic patterns and melodic patterns.']
2025-11-14 15:12:48,369 - backend.pocketflow.lesson_agent - INFO - Searching for teaching strategies with query: teaching strategies pedagogical approaches instructional methods activities
2025-11-14 15:12:52,016 - backend.pocketflow.lesson_agent - INFO - No teaching strategies found in standards
2025-11-14 15:12:52,016 - backend.pocketflow.lesson_agent - INFO - Searching for assessment guidance with query: assessment strategies evaluation methods rubrics formative assessment
2025-11-14 15:12:54,143 - backend.pocketflow.lesson_agent - INFO - No assessment guidance found in standards
2025-11-14 15:12:54,144 - backend.pocketflow.lesson_agent - INFO - No musical topics provided for web search
2025-11-14 15:13:26,601 - backend.pocketflow.lesson_agent - INFO - LLM lesson plan generation took 32.46s
2025-11-14 15:13:26,602 - backend.pocketflow.lesson_agent - INFO - Lesson plan generated in 38.23s (thread pool)
INFO:     127.0.0.1:63418 - "POST /api/sessions/14cecf3e-0da5-41e6-a3bb-03bfac1c21cc/messages/stream HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:15:20,244 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [70092]
INFO:     Started server process [91615]
INFO:     Waiting for application startup.
2025-11-14 15:15:21,281 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:15:21,281 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:15:21,283 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:15:21,283 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:15:21,283 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:15:21,283 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:15:21,284 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:15:21,285 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:15:21,285 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:15:21,285 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:15:21,285 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:15:21,285 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:15:33,417 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [91615]
INFO:     Started server process [96323]
INFO:     Waiting for application startup.
2025-11-14 15:15:34,362 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:15:34,362 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:15:34,365 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:15:34,365 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:15:34,366 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:15:34,367 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:15:34,367 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:15:34,368 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:15:34,368 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:15:34,368 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:15:34,368 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:15:34,368 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:15:43,768 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [96323]
INFO:     Started server process [99612]
INFO:     Waiting for application startup.
2025-11-14 15:15:44,691 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:15:44,692 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:15:44,694 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:15:44,694 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:15:44,694 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:15:44,694 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:15:44,695 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:15:44,695 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:15:44,695 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:15:44,695 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:15:44,695 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:15:44,695 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:15:44,696 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:15:44,696 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:15:44,696 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:15:44,696 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:15:44,696 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:15:44,696 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_objective_formatting.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:15:49,847 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [99612]
INFO:     Started server process [1842]
INFO:     Waiting for application startup.
2025-11-14 15:15:50,747 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:15:50,747 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:15:50,749 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:15:50,749 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:15:50,750 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:15:50,751 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:15:50,751 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:15:50,751 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:15:50,751 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:15:50,751 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:15:50,751 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:16:28,905 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:28,907 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63439 - "GET /api/standards?grade_level=1&strand_code=CREATE HTTP/1.1" 200 OK
2025-11-14 15:16:31,666 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:31,667 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63442 - "GET /api/standards?grade_level=1&strand_code=RESPOND HTTP/1.1" 200 OK
2025-11-14 15:16:40,110 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:40,111 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63445 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:16:40,134 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:40,135 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63448 - "GET /api/standards?grade_level=1&strand_code=RESPOND HTTP/1.1" 200 OK
2025-11-14 15:16:40,158 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:40,159 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63451 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:16:53,568 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:53,569 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:16:53,570 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:16:53,571 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:16:53,571 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:16:53,577 - backend.api.routes.sessions - INFO - Conversation history saved for session 8b930f16-cdd2-4fbf-b8dd-422b2053054c
2025-11-14 15:16:55,998 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.42s
2025-11-14 15:17:07,380 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.96s
2025-11-14 15:17:07,382 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 13.81s (thread pool)
INFO:     127.0.0.1:63456 - "POST /api/sessions/8b930f16-cdd2-4fbf-b8dd-422b2053054c/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:26:17,136 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:26:17,139 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63473 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:26:17,157 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:26:17,158 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63476 - "GET /api/standards?grade_level=1&strand_code=RESPOND HTTP/1.1" 200 OK
2025-11-14 15:26:17,167 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:26:17,168 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63479 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:26:37,671 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:26:37,673 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:26:37,673 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:26:37,674 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:26:37,674 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:26:37,679 - backend.api.routes.sessions - INFO - Conversation history saved for session e0a9b808-28f7-4c54-95b0-539462d7404d
2025-11-14 15:26:39,692 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 2.01s
2025-11-14 15:27:15,341 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.48s
2025-11-14 15:27:15,342 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 37.66s (thread pool)
INFO:     127.0.0.1:63482 - "POST /api/sessions/e0a9b808-28f7-4c54-95b0-539462d7404d/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:27:29,023 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:27:29,024 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:27:29,025 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:27:29,025 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:27:29,025 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:27:29,025 - root - WARNING - Failed to restore agent state: string indices must be integers, not 'str'
2025-11-14 15:27:29,026 - backend.api.routes.sessions - INFO - Restored 3 messages to conversation history
2025-11-14 15:27:29,031 - backend.api.routes.sessions - INFO - Conversation history saved for session e0a9b808-28f7-4c54-95b0-539462d7404d
2025-11-14 15:27:29,056 - backend.pocketflow.lesson_agent - INFO - Filtering objectives: selected_objectives_str=1.RE.1.2 - Explain how musical works are used to communicate meaning., objectives_count=3
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Objective 0: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='1.RE.1.1', standard_id='1.RE.1', objective_text='Identify opposites in tempos, form, texture, articulations, and dynamics in aural or written musical works.', file_id=None)
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Objective 1: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='1.RE.1.2', standard_id='1.RE.1', objective_text='Explain how musical works are used to communicate meaning.', file_id=None)
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Objective 2: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='1.RE.1.3', standard_id='1.RE.1', objective_text='Identify a variety of instruments and voices by sound, including available classroom instruments.', file_id=None)
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Parsed selected_objective_ids: ['1.RE.1.2 - Explain how musical works are used to communicate meaning.']
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=1.RE.1.1, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=1.RE.1.2, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=1.RE.1.3, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - WARNING - No objectives matched selected IDs: ['1.RE.1.2 - Explain how musical works are used to communicate meaning.']
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - WARNING - No objectives matched selected IDs: ['1.RE.1.2 - Explain how musical works are used to communicate meaning.']
2025-11-14 15:27:29,057 - backend.pocketflow.lesson_agent - INFO - Searching for teaching strategies with query: teaching strategies pedagogical approaches instructional methods activities
2025-11-14 15:27:30,845 - backend.pocketflow.lesson_agent - INFO - No teaching strategies found in standards
2025-11-14 15:27:30,846 - backend.pocketflow.lesson_agent - INFO - Searching for assessment guidance with query: assessment strategies evaluation methods rubrics formative assessment
2025-11-14 15:27:57,576 - backend.pocketflow.lesson_agent - INFO - No assessment guidance found in standards
2025-11-14 15:27:57,576 - backend.pocketflow.lesson_agent - INFO - No musical topics provided for web search
2025-11-14 15:28:26,820 - backend.pocketflow.lesson_agent - INFO - LLM lesson plan generation took 29.24s
2025-11-14 15:28:26,821 - backend.pocketflow.lesson_agent - INFO - Lesson plan generated in 57.79s (thread pool)
INFO:     127.0.0.1:63493 - "POST /api/sessions/e0a9b808-28f7-4c54-95b0-539462d7404d/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:29:43,720 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:29:43,721 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:29:43,722 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:29:43,723 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:29:43,723 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:29:43,723 - root - WARNING - Failed to restore agent state: string indices must be integers, not 'str'
2025-11-14 15:29:43,723 - backend.api.routes.sessions - INFO - Restored 6 messages to conversation history
2025-11-14 15:29:43,730 - backend.api.routes.sessions - INFO - Conversation history saved for session e0a9b808-28f7-4c54-95b0-539462d7404d
2025-11-14 15:29:57,754 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 11.24s
2025-11-14 15:29:57,755 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 11.24s (thread pool)
INFO:     127.0.0.1:63501 - "POST /api/sessions/e0a9b808-28f7-4c54-95b0-539462d7404d/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:30:51,939 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:30:51,939 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:30:51,940 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:30:51,941 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:30:51,941 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:30:51,942 - root - WARNING - Failed to restore agent state: string indices must be integers, not 'str'
2025-11-14 15:30:51,942 - backend.api.routes.sessions - INFO - Restored 9 messages to conversation history
2025-11-14 15:30:51,948 - backend.api.routes.sessions - INFO - Conversation history saved for session e0a9b808-28f7-4c54-95b0-539462d7404d
2025-11-14 15:31:06,364 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 10.00s
2025-11-14 15:31:06,365 - backend.pocketflow.lesson_agent - INFO - Conversational response generated in 10.00s (thread pool)
INFO:     127.0.0.1:63509 - "POST /api/sessions/e0a9b808-28f7-4c54-95b0-539462d7404d/messages/stream HTTP/1.1" 200 OK
2025-11-14 15:31:30,584 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:31:30,585 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:31:30,586 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:31:30,587 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:31:30,587 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:31:30,588 - root - WARNING - Failed to restore agent state: string indices must be integers, not 'str'
2025-11-14 15:31:30,588 - backend.api.routes.sessions - INFO - Restored 12 messages to conversation history
2025-11-14 15:31:30,595 - backend.api.routes.sessions - INFO - Conversation history saved for session e0a9b808-28f7-4c54-95b0-539462d7404d
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Filtering objectives: selected_objectives_str=1.RE.1.2 - Explain how musical works are used to communicate meaning., objectives_count=3
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Objective 0: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='1.RE.1.1', standard_id='1.RE.1', objective_text='Identify opposites in tempos, form, texture, articulations, and dynamics in aural or written musical works.', file_id=None)
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Objective 1: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='1.RE.1.2', standard_id='1.RE.1', objective_text='Explain how musical works are used to communicate meaning.', file_id=None)
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Objective 2: type=<class 'backend.repositories.models.Objective'>, repr=Objective(objective_id='1.RE.1.3', standard_id='1.RE.1', objective_text='Identify a variety of instruments and voices by sound, including available classroom instruments.', file_id=None)
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Parsed selected_objective_ids: ['1.RE.1.2 - Explain how musical works are used to communicate meaning.']
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=1.RE.1.1, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:31:30,595 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=1.RE.1.2, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:31:30,596 - backend.pocketflow.lesson_agent - INFO - Checking obj: obj_id=1.RE.1.3, type=<class 'backend.repositories.models.Objective'>
2025-11-14 15:31:30,596 - backend.pocketflow.lesson_agent - WARNING - No objectives matched selected IDs: ['1.RE.1.2 - Explain how musical works are used to communicate meaning.']
2025-11-14 15:31:30,596 - backend.pocketflow.lesson_agent - WARNING - No objectives matched selected IDs: ['1.RE.1.2 - Explain how musical works are used to communicate meaning.']
2025-11-14 15:31:30,596 - backend.pocketflow.lesson_agent - INFO - Searching for teaching strategies with query: teaching strategies pedagogical approaches instructional methods activities
2025-11-14 15:31:55,659 - backend.pocketflow.lesson_agent - INFO - No teaching strategies found in standards
2025-11-14 15:31:55,659 - backend.pocketflow.lesson_agent - INFO - Searching for assessment guidance with query: assessment strategies evaluation methods rubrics formative assessment
2025-11-14 15:31:57,910 - backend.pocketflow.lesson_agent - INFO - No assessment guidance found in standards
2025-11-14 15:31:57,910 - backend.pocketflow.lesson_agent - INFO - No musical topics provided for web search
2025-11-14 15:32:27,773 - backend.pocketflow.lesson_agent - INFO - LLM lesson plan generation took 29.86s
2025-11-14 15:32:27,774 - backend.pocketflow.lesson_agent - INFO - Lesson plan generated in 57.18s (thread pool)
INFO:     127.0.0.1:63515 - "POST /api/sessions/e0a9b808-28f7-4c54-95b0-539462d7404d/messages/stream HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:20,840 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [1842]
INFO:     Started server process [19719]
INFO:     Waiting for application startup.
2025-11-14 15:39:22,027 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:22,027 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:22,030 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:22,031 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:22,032 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:22,032 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:22,032 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:22,033 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:22,033 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:22,033 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:22,033 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:23,347 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [19719]
INFO:     Started server process [20620]
INFO:     Waiting for application startup.
2025-11-14 15:39:24,150 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:24,150 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:24,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:24,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:24,151 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:24,151 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:24,152 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:24,152 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:24,152 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:24,152 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:24,152 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:24,153 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:24,154 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:24,154 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:24,155 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:24,155 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:24,155 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:24,155 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:25,770 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [20620]
INFO:     Started server process [21245]
INFO:     Waiting for application startup.
2025-11-14 15:39:26,518 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:26,518 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:26,519 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:26,519 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:26,520 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:26,521 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:26,521 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:26,521 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:26,521 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:26,521 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:26,521 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:26,522 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/database.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:29,756 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [21245]
INFO:     Started server process [22109]
INFO:     Waiting for application startup.
2025-11-14 15:39:30,592 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:30,592 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:30,596 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:30,596 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:30,597 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:30,598 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:30,598 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:30,598 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:30,598 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:30,598 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:30,598 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:33,833 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [22109]
INFO:     Started server process [23040]
INFO:     Waiting for application startup.
2025-11-14 15:39:34,591 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:34,591 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:34,592 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:34,592 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:34,593 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:34,593 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:34,594 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:34,594 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:34,594 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:34,594 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:34,594 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:34,595 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:34,596 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:34,597 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:34,597 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:34,597 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:34,597 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:34,597 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:36,615 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [23040]
INFO:     Started server process [23631]
INFO:     Waiting for application startup.
2025-11-14 15:39:37,366 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:37,367 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:37,371 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:37,371 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:37,371 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:37,371 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:37,372 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:37,373 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:37,373 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:37,373 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:37,373 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:37,373 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:39:41,518 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [23631]
INFO:     Started server process [24401]
INFO:     Waiting for application startup.
2025-11-14 15:39:42,258 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:39:42,258 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:39:42,259 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:39:42,259 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:39:42,259 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:39:42,259 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:39:42,260 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:39:42,261 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:39:42,261 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:39:42,261 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:39:42,261 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:39:42,261 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:18,017 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [24401]
INFO:     Started server process [24734]
INFO:     Waiting for application startup.
2025-11-14 15:40:19,012 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:19,012 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:19,015 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:19,015 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:19,015 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:19,015 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:19,016 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:19,016 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:19,016 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:19,016 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:40:19,016 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:40:19,016 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:40:19,017 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:40:19,017 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:40:19,017 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:40:19,017 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:40:19,017 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:40:19,017 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:22,856 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [24734]
INFO:     Started server process [25306]
INFO:     Waiting for application startup.
2025-11-14 15:40:23,591 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:23,592 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:23,592 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:40:23,593 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:40:23,594 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:40:23,594 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:40:23,594 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:40:23,595 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:40:23,595 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:40:23,595 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:40:23,595 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/auth/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:27,232 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [25306]
INFO:     Started server process [25511]
INFO:     Waiting for application startup.
2025-11-14 15:40:27,995 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:27,995 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:27,999 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:27,999 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:27,999 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:27,999 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:28,000 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:28,000 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:28,000 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:28,000 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:40:28,000 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:40:28,000 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:40:28,001 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:40:28,001 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:40:28,001 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:40:28,001 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:40:28,001 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:40:28,001 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:33,564 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [25511]
INFO:     Started server process [26560]
INFO:     Waiting for application startup.
2025-11-14 15:40:34,323 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:34,323 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:34,335 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:34,336 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:34,336 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:34,336 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:34,336 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:34,337 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:34,337 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:34,337 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:40:34,337 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:40:34,337 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:40:34,338 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:40:34,338 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:40:34,338 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:40:34,338 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:40:34,338 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:40:34,338 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:37,774 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [26560]
INFO:     Started server process [27136]
INFO:     Waiting for application startup.
2025-11-14 15:40:38,550 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:38,550 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:38,551 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:38,551 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:38,551 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:38,551 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:40:38,552 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:40:38,553 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:40:38,553 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:40:38,553 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:40:38,553 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:40:38,553 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:42,390 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [27136]
INFO:     Started server process [28166]
INFO:     Waiting for application startup.
2025-11-14 15:40:43,155 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:43,155 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:43,157 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:43,158 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:43,158 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:43,158 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:40:43,159 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:40:43,160 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:40:43,160 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:40:43,160 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:40:43,160 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:40:43,160 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:40:49,224 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [28166]
INFO:     Started server process [30555]
INFO:     Waiting for application startup.
2025-11-14 15:40:50,040 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:40:50,040 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:40:50,046 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:40:50,046 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:40:50,047 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:40:50,047 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:40:50,047 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:40:50,047 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:40:50,047 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:40:50,047 - backend.repositories.migrations - ERROR - Extended schema migration failed: 'MigrationManager' object has no attribute '_add_additional_standards_objectives_columns'
2025-11-14 15:40:50,047 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute '_add_additional_standards_objectives_columns'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
  File "/Users/cnowlin/Developer/pocket_musec/backend/repositories/migrations.py", line 63, in migrate
    self.migrate_to_extended_schema()
  File "/Users/cnowlin/Developer/pocket_musec/backend/repositories/migrations.py", line 421, in migrate_to_extended_schema
    self._add_additional_standards_objectives_columns(conn)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute '_add_additional_standards_objectives_columns'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Started server process [30927]
INFO:     Waiting for application startup.
2025-11-14 15:41:15,978 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:41:15,978 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:41:15,982 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:41:15,982 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:41:15,982 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:41:15,983 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:41:15,983 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:41:15,983 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:41:15,983 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:41:15,984 - backend.repositories.migrations - INFO - Added additional_standards column to sessions table
2025-11-14 15:41:15,984 - backend.repositories.migrations - INFO - Added additional_objectives column to sessions table
2025-11-14 15:41:15,984 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:41:15,984 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:41:15,985 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:41:15,985 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:41:15,986 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:41:15,986 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:41:15,986 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:41:15,986 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:41:15,986 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:41:18,918 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [30927]
INFO:     Started server process [31950]
INFO:     Waiting for application startup.
2025-11-14 15:41:19,881 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:41:19,881 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:41:19,881 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:41:19,882 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:41:19,883 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:41:19,883 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:41:19,883 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:41:19,884 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:41:19,884 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:41:19,884 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:41:19,884 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:41:28,426 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,428 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:28,488 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,488 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63609 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:41:28,520 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,520 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63614 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63617 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63618 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63610 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:41:28,567 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,568 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63613 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:41:28,579 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,579 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63624 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:41:28,589 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,589 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63631 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63621 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63632 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63626 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:41:28,605 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,605 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63638 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63641 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:63637 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:41:28,610 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:28,610 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63626 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:63644 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:41:33,856 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:33,857 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:33,874 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:33,874 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:33,889 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:33,890 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63656 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63657 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63662 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63663 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63655 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63659 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:63665 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:41:33,899 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:33,899 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63668 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:41:35,978 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:35,978 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:35,997 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:35,997 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:35,998 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:35,998 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63678 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63682 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63684 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63677 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63686 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63683 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:63665 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:41:36,022 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:36,022 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63689 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:41:48,129 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,130 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:48,162 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,163 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:48,179 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,179 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63705 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63708 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63709 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63710 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63704 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63706 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:41:48,185 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,186 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:48,189 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,189 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:48,204 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,205 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63715 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63719 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:63722 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63724 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63726 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63730 - "GET /api/standards HTTP/1.1" 200 OK
2025-11-14 15:41:48,224 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,224 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63729 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:63733 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:41:48,227 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:48,228 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63719 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:63736 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:41:53,999 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:54,000 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:54,014 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:54,015 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:54,030 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:54,031 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63748 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63750 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63753 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63755 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63746 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63752 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:63760 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:41:54,038 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:54,038 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:54,053 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:54,053 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:41:54,068 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63766 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:41:54,069 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:41:54,069 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63775 - "GET /api/images/storage/info HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63770 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63771 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63774 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63767 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:41:54,073 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63778 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 429 Too Many Requests
2025-11-14 15:41:54,078 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63760 - "GET /api/images/ HTTP/1.1" 429 Too Many Requests
2025-11-14 15:41:54,080 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63781 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 429 Too Many Requests
2025-11-14 15:41:56,237 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:41:56,237 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63790 - "POST /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:41:56,237 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:41:56,237 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63793 - "GET /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:41:56,238 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63795 - "GET /api/images/storage/info HTTP/1.1" 429 Too Many Requests
2025-11-14 15:41:56,238 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63796 - "GET /api/images HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63799 - "GET /api/standards HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63800 - "GET /api/drafts HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:22,699 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:42:22,699 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:42:22,699 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:42:22,699 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63835 - "POST /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:22,699 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63836 - "GET /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:22,700 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63837 - "GET /api/images HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63840 - "GET /api/drafts HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63841 - "GET /api/images/storage/info HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63843 - "GET /api/standards HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:24,722 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:42:24,722 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63852 - "POST /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:24,722 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63853 - "GET /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:24,722 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63856 - "GET /api/images/storage/info HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63857 - "GET /api/images HTTP/1.1" 429 Too Many Requests
2025-11-14 15:42:24,723 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:42:24,723 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:63860 - "GET /api/standards HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:63861 - "GET /api/drafts HTTP/1.1" 429 Too Many Requests
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:42:58,940 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [31950]
INFO:     Started server process [57401]
INFO:     Waiting for application startup.
2025-11-14 15:43:00,019 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:00,019 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:00,022 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:00,022 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:00,022 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:00,022 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:00,023 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:00,024 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:00,024 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:00,024 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:00,024 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:00,024 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/llm/prompt_templates.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:43:04,782 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [57401]
INFO:     Started server process [58882]
INFO:     Waiting for application startup.
2025-11-14 15:43:05,629 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:05,629 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:05,630 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:05,630 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:05,631 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:05,632 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:05,632 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:05,632 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:05,633 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:05,633 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:05,633 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:05,633 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:43:06,442 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [58882]
INFO:     Started server process [59300]
INFO:     Waiting for application startup.
2025-11-14 15:43:07,279 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:07,279 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:07,282 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:07,283 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:07,283 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:07,283 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:07,283 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:07,283 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:07,284 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:07,285 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:07,285 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:07,285 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:07,285 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:07,285 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/llm/prompt_templates.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:43:16,481 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [59300]
INFO:     Started server process [62203]
INFO:     Waiting for application startup.
2025-11-14 15:43:17,375 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:17,375 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:17,377 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:17,378 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:17,378 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:17,378 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:17,379 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:17,380 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:17,380 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:17,380 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:17,380 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:17,380 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/llm/prompt_templates.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:43:20,617 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [62203]
INFO:     Started server process [62615]
INFO:     Waiting for application startup.
2025-11-14 15:43:21,458 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:21,458 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:21,458 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:21,459 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:21,460 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:21,460 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:21,460 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:21,460 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:21,460 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:21,461 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:21,461 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:21,461 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:21,461 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:63871 - "GET /health HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_additional_standards.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:43:41,668 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [62615]
INFO:     Started server process [66480]
INFO:     Waiting for application startup.
2025-11-14 15:43:42,685 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:42,685 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:42,688 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:42,688 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:42,689 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:42,690 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:42,690 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:42,690 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:42,690 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:42,690 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:42,690 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:42,690 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:43:43,561 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:43:43,562 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63875 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:43:43,569 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:43:43,569 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63877 - "GET /api/sessions/9c0b5bc0-e27f-4a39-a4b8-d4a6e298aff7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:63879 - "POST /api/sessions/9c0b5bc0-e27f-4a39-a4b8-d4a6e298aff7/chat HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'test_additional_standards.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:43:54,916 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [66480]
INFO:     Started server process [68790]
INFO:     Waiting for application startup.
2025-11-14 15:43:55,981 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:43:55,981 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:43:55,984 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:43:55,984 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:43:55,985 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:43:55,986 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:43:55,986 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:43:55,986 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:43:55,987 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:43:55,987 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:43:55,987 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:43:55,987 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_additional_standards.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:44:00,132 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [68790]
INFO:     Started server process [69923]
INFO:     Waiting for application startup.
2025-11-14 15:44:01,169 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:44:01,169 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:44:01,171 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:44:01,172 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:44:01,172 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:44:01,172 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:44:01,173 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:44:01,174 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:44:01,174 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:44:01,175 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:44:01,175 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:44:01,175 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:44:01,175 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:44:01,175 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:44:02,164 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:02,164 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63886 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:44:02,175 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:02,175 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63888 - "GET /api/sessions/12048b15-d5f2-4fe5-8c66-4c6a766313d4 HTTP/1.1" 200 OK
2025-11-14 15:44:02,179 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:02,179 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:44:02,179 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:02,179 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:44:02,179 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:44:02,181 - backend.api.routes.sessions - INFO - Conversation history saved for session 12048b15-d5f2-4fe5-8c66-4c6a766313d4
2025-11-14 15:44:06,555 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 4.37s
2025-11-14 15:44:15,873 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 7.52s
2025-11-14 15:44:15,874 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 13.69s (thread pool)
INFO:     127.0.0.1:63890 - "POST /api/sessions/12048b15-d5f2-4fe5-8c66-4c6a766313d4/messages HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_additional_standards.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:44:24,356 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [69923]
INFO:     Started server process [71281]
INFO:     Waiting for application startup.
2025-11-14 15:44:25,527 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:44:25,527 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:44:25,529 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:44:25,529 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:44:25,530 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:44:25,531 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:44:25,531 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:44:25,532 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:44:25,532 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:44:25,532 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:44:25,532 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:44:25,532 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:44:26,254 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:26,254 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63898 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:44:26,260 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:26,261 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63900 - "GET /api/sessions/e1bbb8c4-ce7c-486b-85c7-6f81405fa39e HTTP/1.1" 200 OK
2025-11-14 15:44:26,264 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:26,264 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:44:26,264 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:44:26,265 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:44:26,265 - backend.pocketflow.lesson_agent - INFO - Chutes client initialized successfully
2025-11-14 15:44:26,267 - backend.api.routes.sessions - INFO - Conversation history saved for session e1bbb8c4-ce7c-486b-85c7-6f81405fa39e
2025-11-14 15:44:28,015 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 1.75s
2025-11-14 15:45:02,789 - backend.pocketflow.lesson_agent - INFO - LLM chat completion took 9.47s
2025-11-14 15:45:02,791 - backend.pocketflow.lesson_agent - INFO - Conversational welcome completed in 36.52s (thread pool)
2025-11-14 15:45:02,802 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,803 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63902 - "POST /api/sessions/e1bbb8c4-ce7c-486b-85c7-6f81405fa39e/messages HTTP/1.1" 200 OK
2025-11-14 15:45:02,860 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,861 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:45:02,877 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,877 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63937 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63939 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63940 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63941 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:63936 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63938 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:45:02,886 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,886 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:45:02,889 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,889 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:45:02,898 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,899 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63952 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:45:02,919 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,920 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63958 - "GET /api/standards?strand_code=CREATE HTTP/1.1" 200 OK
INFO:     127.0.0.1:63960 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:63956 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:63961 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:63963 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:63965 - "GET /api/standards HTTP/1.1" 200 OK
2025-11-14 15:45:02,956 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,956 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63968 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:63971 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:63956 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:45:02,965 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:45:02,966 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:63974 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:47:17,941 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:17,945 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:18,005 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,006 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:18,009 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,009 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64005 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64010 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64011 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64001 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:47:18,016 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,016 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64004 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64009 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:47:18,046 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,046 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64014 - "GET /api/standards HTTP/1.1" 200 OK
2025-11-14 15:47:18,070 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,070 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64018 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64020 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64025 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64028 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64022 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:47:18,075 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,075 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:18,112 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:18,112 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64034 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64031 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64037 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64022 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:47:23,237 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,243 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:23,310 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,310 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:23,332 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,332 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64049 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64050 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64052 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64056 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64046 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64055 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:47:23,340 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,341 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:23,342 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,344 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:23,364 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,364 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64064 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64068 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64066 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64071 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64072 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64076 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64075 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:47:23,460 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,460 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64079 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64066 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:47:23,464 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:23,465 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64082 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:47:27,865 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,865 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:27,883 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,883 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64095 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64096 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64098 - "GET /api/drafts HTTP/1.1" 200 OK
2025-11-14 15:47:27,885 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,886 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64090 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:47:27,889 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,890 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:27,906 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,906 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64100 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64099 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64103 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64108 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64109 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64114 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64111 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:47:27,923 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,923 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:27,925 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,925 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64121 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64123 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64120 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:47:27,944 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:27,945 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64111 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64126 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:47:33,746 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:33,746 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:33,757 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:33,757 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64137 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:47:33,783 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:33,783 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64142 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64145 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64146 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64138 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64141 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64148 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:47:33,792 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:33,792 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64151 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:47:36,376 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:36,377 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:47:36,384 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:47:36,384 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:47:36,385 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:47:36,385 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64169 - "GET /api/drafts HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:64170 - "GET /api/standards HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:64164 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64165 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64160 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64166 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:47:36,392 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:64148 - "GET /api/images/ HTTP/1.1" 429 Too Many Requests
2025-11-14 15:47:36,394 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:64173 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 429 Too Many Requests
2025-11-14 15:47:39,081 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:47:39,082 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:47:39,082 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
2025-11-14 15:47:39,083 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:64181 - "POST /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:47:39,085 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:64184 - "GET /api/sessions HTTP/1.1" 429 Too Many Requests
2025-11-14 15:47:39,085 - backend.api.middleware - WARNING - Rate limit exceeded for IP: 127.0.0.1
INFO:     127.0.0.1:64185 - "GET /api/images HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:64187 - "GET /api/drafts HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:64190 - "GET /api/images/storage/info HTTP/1.1" 429 Too Many Requests
INFO:     127.0.0.1:64191 - "GET /api/standards HTTP/1.1" 429 Too Many Requests
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:48:41,805 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [71281]
INFO:     Started server process [85855]
INFO:     Waiting for application startup.
2025-11-14 15:48:43,351 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:48:43,351 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:48:43,354 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:48:43,354 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:48:43,355 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:48:43,356 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:48:43,356 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:48:43,356 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:48:43,356 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:48:43,356 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:48:43,356 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:48:45,599 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:48:45,599 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:48:45,614 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:48:45,615 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:48:45,643 - backend.api.main - ERROR - Unexpected error: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in list_sessions
    return [_session_to_response(session, standard_repo) for session in sessions]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in <listcomp>
    return [_session_to_response(session, standard_repo) for session in sessions]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64213 - "GET /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in list_sessions
    return [_session_to_response(session, standard_repo) for session in sessions]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in <listcomp>
    return [_session_to_response(session, standard_repo) for session in sessions]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
2025-11-14 15:48:45,651 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:48:45,651 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64218 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64220 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64222 - "GET /api/drafts HTTP/1.1" 200 OK
2025-11-14 15:48:45,656 - backend.api.main - ERROR - Unexpected error: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64214 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64217 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64224 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:49:02,334 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:02,347 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:02,414 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:02,415 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:02,447 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:02,448 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64237 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
2025-11-14 15:49:02,450 - backend.api.main - ERROR - Unexpected error: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in list_sessions
    return [_session_to_response(session, standard_repo) for session in sessions]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in <listcomp>
    return [_session_to_response(session, standard_repo) for session in sessions]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64238 - "GET /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in list_sessions
    return [_session_to_response(session, standard_repo) for session in sessions]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in <listcomp>
    return [_session_to_response(session, standard_repo) for session in sessions]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64243 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64244 - "GET /api/standards HTTP/1.1" 200 OK
2025-11-14 15:49:02,455 - backend.api.main - ERROR - Unexpected error: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64234 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64240 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:49:02,458 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:02,459 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:02,462 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:02,463 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:02,480 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:02,480 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64251 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
2025-11-14 15:49:02,508 - backend.api.main - ERROR - Unexpected error: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in list_sessions
    return [_session_to_response(session, standard_repo) for session in sessions]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in <listcomp>
    return [_session_to_response(session, standard_repo) for session in sessions]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64255 - "GET /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in list_sessions
    return [_session_to_response(session, standard_repo) for session in sessions]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 144, in <listcomp>
    return [_session_to_response(session, standard_repo) for session in sessions]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
2025-11-14 15:49:02,509 - backend.api.main - ERROR - Unexpected error: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64247 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for SessionResponse
additional_standards
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
additional_objectives
  Input should be a valid string [type=string_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.5/v/string_type
INFO:     127.0.0.1:64256 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64260 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64264 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64262 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64264 - "GET /api/images/ HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_selection_based_system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:49:12,810 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [85855]
INFO:     Started server process [88010]
INFO:     Waiting for application startup.
2025-11-14 15:49:14,380 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:49:14,380 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:49:14,383 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:49:14,383 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:49:14,383 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:49:14,383 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:49:14,384 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:49:14,385 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:49:14,385 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:49:14,385 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:49:14,385 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:49:14,385 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:49:18,134 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [88010]
INFO:     Started server process [88339]
INFO:     Waiting for application startup.
2025-11-14 15:49:19,084 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:49:19,084 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:49:19,085 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:49:19,085 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:49:19,086 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:49:19,086 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:49:19,086 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:49:19,087 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:49:19,088 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:49:19,089 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:49:19,089 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:49:19,089 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:49:19,089 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:49:19,089 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:49:19,090 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:49:19,090 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:49:19,091 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:49:19,091 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:49:19,091 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:49:19,091 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:49:21,055 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:21,057 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:21,063 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64271 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-11-14 15:49:21,073 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:21,073 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:21,077 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64273 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-11-14 15:49:23,564 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:23,566 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:23,575 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64275 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64277 - "GET /health HTTP/1.1" 200 OK
2025-11-14 15:49:46,019 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:46,020 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:46,026 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64280 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-11-14 15:49:46,031 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:46,032 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:46,035 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64282 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-11-14 15:49:48,837 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:48,837 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64285 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:49:51,354 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:51,355 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:51,360 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64288 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-11-14 15:49:53,908 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:49:53,910 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:49:53,913 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64290 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-11-14 15:50:19,896 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:50:19,898 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:50:19,905 - backend.api.main - ERROR - Unexpected error: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
INFO:     127.0.0.1:64292 - "POST /api/sessions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 66, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/middleware.py", line 56, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 134, in create_session
    return _session_to_response(session, standard_repo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 89, in _session_to_response
    return SessionResponse(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SessionResponse
additional_standards.0
  Input should be a valid dictionary [type=dict_type, input_value=StandardResponse(id='3.CN...logy.'], last_used=None), input_type=StandardResponse]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
WARNING:  WatchFiles detected changes in 'debug_session_conversion.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:50:23,464 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [88339]
INFO:     Started server process [96505]
INFO:     Waiting for application startup.
2025-11-14 15:50:25,284 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:50:25,284 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:50:25,286 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:50:25,286 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:50:25,286 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:50:25,287 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:50:25,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:50:25,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:50:25,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:50:25,288 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:50:25,288 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:50:25,288 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:50:25,288 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:50:39,619 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [96505]
INFO:     Started server process [99608]
INFO:     Waiting for application startup.
2025-11-14 15:50:40,957 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:50:40,957 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:50:40,958 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:50:40,959 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:50:40,959 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:50:40,959 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:50:40,960 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:50:40,961 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:50:40,961 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:50:40,962 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:50:40,962 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:50:40,962 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:50:40,962 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:50:40,962 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_session_api_fix.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:51:53,326 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [99608]
WARNING:  WatchFiles detected changes in 'test_session_api_fix.py'. Reloading...
INFO:     Started server process [3097]
INFO:     Waiting for application startup.
2025-11-14 15:51:54,811 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:51:54,811 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:51:54,814 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:51:54,814 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:51:54,815 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:51:54,815 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:51:54,816 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:51:54,817 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:51:54,817 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:51:54,817 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:51:54,817 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:51:54,817 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:51:54,818 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_check_standards.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:51:58,272 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [3097]
INFO:     Started server process [4224]
INFO:     Waiting for application startup.
2025-11-14 15:51:59,747 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:51:59,747 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:51:59,752 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:51:59,753 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:51:59,753 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:51:59,753 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:51:59,754 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:51:59,755 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:51:59,755 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:51:59,755 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:51:59,756 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:51:59,756 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:51:59,756 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:51:59,756 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'test_session_api_fix.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:52:07,633 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [4224]
INFO:     Started server process [5962]
INFO:     Waiting for application startup.
2025-11-14 15:52:09,127 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:52:09,128 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:52:09,130 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:52:09,130 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:52:09,130 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:52:09,130 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:52:09,131 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:52:09,132 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:52:09,132 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:52:09,133 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:52:09,133 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:52:09,133 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:52:09,133 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:52:19,349 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:19,351 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64320 - "GET /api/standards HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_session_creation.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:52:22,555 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [5962]
INFO:     Started server process [6675]
INFO:     Waiting for application startup.
2025-11-14 15:52:24,306 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:52:24,307 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:52:24,308 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:52:24,309 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:52:24,309 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:52:24,309 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:52:24,310 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:52:24,311 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:52:24,311 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:52:24,311 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:52:24,311 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:52:24,311 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:52:24,966 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:24,966 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64324 - "POST /api/sessions HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'test_session_creation.py', 'test_check_standards.py', 'test_session_api_fix.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 15:52:39,544 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [6675]
INFO:     Started server process [8415]
INFO:     Waiting for application startup.
2025-11-14 15:52:41,388 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 15:52:41,388 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 15:52:41,402 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 15:52:41,402 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 15:52:41,403 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 15:52:41,404 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 15:52:41,404 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 15:52:41,404 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 15:52:41,404 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 15:52:41,404 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 15:52:41,404 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 15:52:41,405 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 15:52:41,405 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 15:52:41,405 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 15:52:41,405 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 15:52:41,405 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 15:52:41,406 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 15:52:41,406 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 15:52:41,406 - backend.api.main - INFO - Database migrations completed
2025-11-14 15:52:41,406 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
2025-11-14 15:52:41,414 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,414 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:52:41,471 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,471 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:52:41,499 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,499 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64340 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64341 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64345 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64346 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64339 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:52:41,533 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,534 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64347 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:52:41,583 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,583 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:52:41,608 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,608 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64357 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64359 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:52:41,612 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,612 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64361 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64352 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64364 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64355 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64367 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64370 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64352 - "GET /api/images/ HTTP/1.1" 200 OK
2025-11-14 15:52:41,620 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:52:41,621 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64375 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:53:33,481 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,488 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:53:33,620 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,620 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64388 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64391 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64394 - "GET /api/drafts HTTP/1.1" 200 OK
2025-11-14 15:53:33,625 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,625 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64387 - "POST /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:53:33,628 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,628 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:53:33,664 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,664 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64393 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64395 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64399 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64401 - "GET /api/sessions HTTP/1.1" 200 OK
2025-11-14 15:53:33,711 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,712 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64406 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64409 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64403 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64414 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64415 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:53:33,718 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,719 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:53:33,740 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:53:33,740 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64420 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64421 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
INFO:     127.0.0.1:64403 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64434 - "GET /health HTTP/1.1" 200 OK
2025-11-14 15:55:29,087 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,095 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:55:29,174 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,175 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:55:29,192 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,192 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64451 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64455 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64458 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64459 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64450 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64456 - "GET /api/images/storage/info HTTP/1.1" 200 OK
2025-11-14 15:55:29,204 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,204 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:55:29,221 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,221 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:55:29,234 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,234 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
2025-11-14 15:55:29,258 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,258 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64467 - "GET /api/images HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:64470 - "GET /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64463 - "POST /api/sessions HTTP/1.1" 200 OK
INFO:     127.0.0.1:64465 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64475 - "GET /api/drafts HTTP/1.1" 200 OK
INFO:     127.0.0.1:64476 - "GET /api/standards HTTP/1.1" 200 OK
INFO:     127.0.0.1:64479 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:55:29,265 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:55:29,266 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64482 - "GET /api/images/storage/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:64465 - "GET /api/images/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64485 - "GET /api/standards?grade_level=3&strand_code=CONNECT HTTP/1.1" 200 OK
2025-11-14 15:58:01,560 - backend.llm.embeddings - INFO - Initializing embeddings tables with proper transaction management
2025-11-14 15:58:01,566 - backend.llm.embeddings - INFO - Successfully initialized embeddings tables
INFO:     127.0.0.1:64499 - "GET /api/standards?grade_level=1 HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend/llm/model_router.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:08:51,346 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [8415]
WARNING:  WatchFiles detected changes in 'backend/llm/model_router.py'. Reloading...
INFO:     Started server process [45305]
INFO:     Waiting for application startup.
2025-11-14 16:08:53,293 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:08:53,293 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:08:53,296 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:08:53,297 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:08:53,297 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:08:53,297 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:08:53,298 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:08:53,299 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:08:53,299 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:08:53,299 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:08:53,299 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:08:53,299 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:08:53,299 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/llm/model_router.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:08:55,519 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [45305]
Process SpawnProcess-97:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/settings.py", line 9, in <module>
    from ...llm.model_router import ModelRouter
  File "/Users/cnowlin/Developer/pocket_musec/backend/llm/__init__.py", line 3, in <module>
    from .unified_client import UnifiedLLMClient, ClientType, create_llm_client
  File "/Users/cnowlin/Developer/pocket_musec/backend/llm/unified_client.py", line 10, in <module>
    from .model_router import ProcessingMode, ModelRouter
  File "/Users/cnowlin/Developer/pocket_musec/backend/llm/model_router.py", line 123
    def _generate_local(
                        ^
IndentationError: unindent does not match any outer indentation level
WARNING:  WatchFiles detected changes in 'backend/llm/model_router.py'. Reloading...
INFO:     Started server process [46093]
INFO:     Waiting for application startup.
2025-11-14 16:09:04,816 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:04,816 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:04,821 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:04,822 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:04,823 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:04,823 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:04,823 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:04,823 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:04,823 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:04,823 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:04,824 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:04,824 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:04,824 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:04,826 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:04,826 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:04,826 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:04,827 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:04,827 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:04,827 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:04,827 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/llm/model_router.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:09:06,033 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [46093]
Process SpawnProcess-99:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/settings.py", line 9, in <module>
    from ...llm.model_router import ModelRouter
  File "/Users/cnowlin/Developer/pocket_musec/backend/llm/__init__.py", line 3, in <module>
    from .unified_client import UnifiedLLMClient, ClientType, create_llm_client
  File "/Users/cnowlin/Developer/pocket_musec/backend/llm/unified_client.py", line 10, in <module>
    from .model_router import ProcessingMode, ModelRouter
  File "/Users/cnowlin/Developer/pocket_musec/backend/llm/model_router.py", line 126
    def _generate_local(
                        ^
IndentationError: unindent does not match any outer indentation level
WARNING:  WatchFiles detected changes in 'backend/llm/model_router.py'. Reloading...
INFO:     Started server process [46609]
INFO:     Waiting for application startup.
2025-11-14 16:09:11,016 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:11,016 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:11,020 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:11,020 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:11,021 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:11,021 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:11,021 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:11,022 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:11,023 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:11,023 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:11,023 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:11,024 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:11,024 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:11,024 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/auth/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:09:22,157 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [46609]
INFO:     Started server process [47087]
INFO:     Waiting for application startup.
2025-11-14 16:09:23,491 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:23,491 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:23,494 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:23,494 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:23,495 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:23,496 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:23,496 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:23,496 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:23,497 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:23,497 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:23,497 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:23,497 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:09:24,204 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [47087]
INFO:     Started server process [47154]
INFO:     Waiting for application startup.
2025-11-14 16:09:25,168 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:25,168 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:25,169 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:25,170 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:25,170 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:25,170 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:25,171 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:25,172 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:25,172 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:25,172 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:25,173 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:25,173 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:25,173 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:25,173 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:09:25,981 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [47154]
INFO:     Started server process [47227]
INFO:     Waiting for application startup.
2025-11-14 16:09:27,136 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:27,136 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:27,137 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:27,137 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:27,137 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:27,137 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:27,138 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:27,139 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:27,139 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:27,140 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:27,140 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:27,140 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:27,140 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:27,140 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:09:27,747 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [47227]
INFO:     Started server process [47300]
INFO:     Waiting for application startup.
2025-11-14 16:09:28,626 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:28,626 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:28,627 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:28,627 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:28,627 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:28,627 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:28,628 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:28,629 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:28,629 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:28,629 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:28,629 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:28,629 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:28,629 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/models.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:09:29,740 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [47300]
INFO:     Started server process [47372]
INFO:     Waiting for application startup.
2025-11-14 16:09:30,639 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:09:30,639 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:09:30,641 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:09:30,641 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:09:30,642 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:09:30,643 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:09:30,643 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:09:30,643 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:09:30,643 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:09:30,643 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:09:30,644 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:09:30,644 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:10:35,527 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [47372]
INFO:     Started server process [49049]
INFO:     Waiting for application startup.
2025-11-14 16:10:36,945 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:10:36,945 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:10:36,949 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:10:36,950 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:10:36,950 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:10:36,950 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:10:36,951 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:10:36,954 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:10:36,955 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:10:36,955 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:10:36,955 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:10:36,956 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:10:36,956 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:10:36,956 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:10:37,663 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49049]
INFO:     Started server process [49126]
INFO:     Waiting for application startup.
2025-11-14 16:10:38,677 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:10:38,677 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:10:38,678 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:10:38,678 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:10:38,679 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:10:38,680 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:10:38,680 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:10:38,680 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:10:38,681 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:10:38,681 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:10:38,681 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:10:38,681 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:10:40,098 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49126]
INFO:     Started server process [49203]
INFO:     Waiting for application startup.
2025-11-14 16:10:41,126 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:10:41,126 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:10:41,126 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:10:41,127 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:10:41,128 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:10:41,128 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:10:41,128 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:10:41,128 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:10:41,128 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:10:41,129 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:10:41,129 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:10:41,129 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:10:41,129 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/pocketflow/lesson_agent.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:10:42,241 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49203]
INFO:     Started server process [49286]
INFO:     Waiting for application startup.
2025-11-14 16:10:43,791 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:10:43,791 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:10:43,794 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:10:43,794 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:10:43,795 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:10:43,796 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:10:43,796 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:10:43,796 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:10:43,797 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:10:43,797 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:10:43,797 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:10:43,797 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:10:46,325 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49286]
INFO:     Started server process [49437]
INFO:     Waiting for application startup.
2025-11-14 16:10:47,209 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:10:47,209 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:10:47,210 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:10:47,210 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:10:47,211 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:10:47,212 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:10:47,212 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:10:47,212 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:10:47,212 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:10:47,212 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:10:47,212 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:11:03,629 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49437]
INFO:     Started server process [49522]
INFO:     Waiting for application startup.
2025-11-14 16:11:04,941 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:11:04,941 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:11:04,944 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:11:04,944 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:11:04,944 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:11:04,944 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:11:04,945 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:11:04,946 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:11:04,946 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:11:04,948 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:11:04,948 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:11:04,948 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:11:04,948 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:11:05,861 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49522]
INFO:     Started server process [49600]
INFO:     Waiting for application startup.
2025-11-14 16:11:06,746 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:11:06,746 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:11:06,747 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:11:06,747 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:11:06,748 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:11:06,749 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:11:06,749 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:11:06,749 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:11:06,749 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:11:06,749 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:11:06,749 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:11:06,749 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:11:13,031 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [49600]
Process SpawnProcess-113:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 10, in <module>
    from .routes import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/__init__.py", line 3, in <module>
    from . import (
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/routes/sessions.py", line 397
    raise HTTPException(
IndentationError: expected an indented block after 'if' statement on line 396
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Started server process [50045]
INFO:     Waiting for application startup.
2025-11-14 16:11:17,343 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:11:17,343 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:11:17,346 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:11:17,346 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:11:17,347 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:11:17,348 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:11:17,348 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:11:17,348 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:11:17,349 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:11:17,349 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:11:17,349 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:11:17,350 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:11:17,350 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:11:17,350 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:11:22,523 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [50045]
INFO:     Started server process [50355]
INFO:     Waiting for application startup.
2025-11-14 16:11:23,343 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:11:23,343 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:11:23,344 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:11:23,344 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:11:23,344 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:11:23,344 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:11:23,345 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:11:23,346 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:11:23,346 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:11:23,346 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:11:23,346 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:11:23,346 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:11:24,660 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [50355]
INFO:     Started server process [50437]
INFO:     Waiting for application startup.
2025-11-14 16:11:25,485 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:11:25,485 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:11:25,488 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:11:25,488 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:11:25,488 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:11:25,488 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:11:25,489 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:11:25,490 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:11:25,490 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:11:25,490 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:11:25,490 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:11:25,490 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:11:25,490 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:11:26,703 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [50437]
INFO:     Started server process [50520]
INFO:     Waiting for application startup.
2025-11-14 16:11:27,543 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:11:27,543 - backend.repositories.migrations - INFO - Starting database migration...
2025-11-14 16:11:27,544 - backend.repositories.migrations - INFO - Database already at version 8, skipping standards migration
2025-11-14 16:11:27,544 - backend.repositories.migrations - INFO - Database already at version 8, skipping M3 migration
2025-11-14 16:11:27,544 - backend.repositories.migrations - INFO - Database already at version 8, skipping v4 migration
2025-11-14 16:11:27,544 - backend.repositories.migrations - INFO - Starting extended schema migration...
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - Created unpacking document tables
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - Created alignment document tables
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - Created reference document tables
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - additional_standards column already exists in sessions table
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - additional_objectives column already exists in sessions table
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - Created extended table indexes
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - Extended schema migration completed successfully
2025-11-14 16:11:27,545 - backend.repositories.migrations - INFO - Database already at version 8, skipping drafts migration
2025-11-14 16:11:27,546 - backend.repositories.migrations - INFO - Database already at version 8, skipping Kindergarten migration
2025-11-14 16:11:27,546 - backend.repositories.migrations - INFO - Database already at version 8, skipping file storage migration
2025-11-14 16:11:27,546 - backend.repositories.migrations - INFO - Database already at version 8, skipping file linking migration
2025-11-14 16:11:27,546 - backend.repositories.migrations - INFO - All migrations completed successfully
2025-11-14 16:11:27,546 - backend.api.main - INFO - Database migrations completed
2025-11-14 16:11:27,546 - backend.api.main - INFO - PocketMusec API started successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-11-14 16:12:19,587 - backend.api.main - INFO - Shutting down PocketMusec API...
INFO:     Application shutdown complete.
INFO:     Finished server process [50520]
Process SpawnProcess-118:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/config.py", line 467, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1126, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/__init__.py", line 3, in <module>
    from .main import app
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 24, in <module>
    from ..repositories.migrations import MigrationManager
  File "/Users/cnowlin/Developer/pocket_musec/backend/repositories/migrations.py", line 40
    finally:
SyntaxError: expected 'except' or 'finally' block
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Started server process [52349]
INFO:     Waiting for application startup.
2025-11-14 16:12:33,756 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:12:33,756 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Started server process [52435]
INFO:     Waiting for application startup.
2025-11-14 16:12:36,513 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:12:36,513 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/repositories/session_repository.py'. Reloading...
INFO:     Started server process [52554]
INFO:     Waiting for application startup.
2025-11-14 16:13:10,236 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:13:10,237 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Started server process [52727]
INFO:     Waiting for application startup.
2025-11-14 16:13:13,820 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:13:13,821 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/api/routes/sessions.py'. Reloading...
INFO:     Started server process [53080]
INFO:     Waiting for application startup.
2025-11-14 16:13:19,590 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 16:13:19,590 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [58022]
INFO:     Waiting for application startup.
2025-11-14 17:06:55,273 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:06:55,273 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/repositories/migrations.py'. Reloading...
INFO:     Started server process [58286]
INFO:     Waiting for application startup.
2025-11-14 17:07:45,270 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:07:45,270 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/conftest.py'. Reloading...
INFO:     Started server process [60974]
INFO:     Waiting for application startup.
2025-11-14 17:24:09,724 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:24:09,724 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/conftest.py'. Reloading...
INFO:     Started server process [61339]
INFO:     Waiting for application startup.
2025-11-14 17:24:45,751 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:24:45,751 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [61426]
INFO:     Waiting for application startup.
2025-11-14 17:24:55,093 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:24:55,093 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [61608]
INFO:     Waiting for application startup.
2025-11-14 17:25:06,849 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:25:06,849 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [61717]
INFO:     Waiting for application startup.
2025-11-14 17:25:15,791 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:25:15,791 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [61807]
INFO:     Waiting for application startup.
2025-11-14 17:25:24,183 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:25:24,183 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/conftest.py'. Reloading...
INFO:     Started server process [62184]
INFO:     Waiting for application startup.
2025-11-14 17:25:57,592 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:25:57,592 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [62926]
INFO:     Waiting for application startup.
2025-11-14 17:26:58,278 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:26:58,278 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [63017]
INFO:     Waiting for application startup.
2025-11-14 17:27:04,778 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:27:04,778 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'backend/tests/test_api/test_model_selection.py'. Reloading...
INFO:     Started server process [63110]
INFO:     Waiting for application startup.
2025-11-14 17:27:11,458 - backend.api.main - INFO - Starting PocketMusec API...
2025-11-14 17:27:11,458 - backend.api.main - ERROR - Migration failed: 'MigrationManager' object has no attribute 'migrate'
ERROR:    Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 566, in __aenter__
    await self._router.startup()
  File "/opt/homebrew/lib/python3.11/site-packages/starlette/routing.py", line 654, in startup
    await handler()
  File "/Users/cnowlin/Developer/pocket_musec/backend/api/main.py", line 110, in startup_event
    migration_manager.migrate()
    ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationManager' object has no attribute 'migrate'

ERROR:    Application startup failed. Exiting.
INFO:     Stopping reloader process [80830]
